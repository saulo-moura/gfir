<style type="text/css">

   div#conteudo {
        padding:0px;
        margin:0px;
        margin-left:10px;
        swidth:670px;
        swidth:2000px;
        overflow:auto;
    }

    body {
        swidth:2000px;
        background:#FFFFFF;
    }

    div#conteudo img {
        text-align:center;
    }
    div#area_mostra {
        text-align:center;
        background:#FFFFFF;
        height:auto;
        swidth:100%;
    }

    div#barra {
        margin-bottom:5px;
        height:15px;
    }

    div#img {
        background-color:white;
        margin-top:3px;
    }
    div#tit_home {

        float:right;
        padding-bottom: 2px;
        padding-top: 3px;
        padding-left: 5px;
        padding-right: 37px;
        margin-bottom: 14px;
        font-size: 14px;
        font-weight: bold;
        color: #90141a;
        color: #B70909;
        background: #c9c9c9;
        sbackground: #B70909;

        background: #FFFFFF;

        sbackground: url(imagens/seta_titulo.jpg) right top no-repeat #c9c9c9;
        sborder:2px solid red;
    }
    div#tit_home_img {
        float:right;
        sborder:2px solid green;

    }
    div#tit_home_img a {
        text-decoration:none;
    }

    div#tit_home_img a:visited {
        text-decoration:none;
    }

table.tabela_titulo {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 16px;
	font-weight:bold;
	color: #F7F7F7;
	padding-left:10px;
	text-align: center;
	border-collapse: collapse;
	background: #EBEBEB url(imagens/rodape_lista.jpg) repeat ;
}
td.titulo_lista {

	border-collapse: collapse;
	padding-right: 20px;

}
td.titulo_campo {
    padding-top:0px;
	padding-bottom:5px;
	padding-right: 20px;
}
tr.cabecalho_lista {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;
	color: #6E6E6E;
	font-weight:bold;
    text-align: right;
	border-collapse: collapse;
	background-color: #EFEFEF;
}

td.cabecalho_campo {
    padding-top:5px;
	padding-bottom:5px;
 	padding-right: 4px;
	padding-left : 4px;
    border-bottom:1px solid #808080;

}


tr.rodape_lista {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 4px;
	color: #FFFFFF;
	font-weight:bold;
    text-align: right;
	border-collapse: collapse;
	background: #EBEBEB url(imagens/rodape_lista.jpg) repeat ;
	sbackground: #F1F1F1 ;
	background: #FFFFFF ;

	height:3px;
}

td.rodape_campo {
    padding-top:2px;
	padding-bottom:2px;
	padding-right: 20px;

}

tr.linha_lista {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;
	color: #000000;
	font-weight:normal;
	text-align: right;
	border-collapse: collapse;
	background-color: #F0F0F0;
	background-color: #FBFBFB;



}

tr.linha_rodape {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;
	color: #FFFFFF;
	font-weight:bold;
	text-align: right;
	border-collapse: collapse;
	background: #A3A3A3;
}
td.linha_campo_rodape {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 20px;
	border-bottom:1px solid #C0C0C0;
	sbackground:#E6E6E6;
}




td.linha_campo {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 20px;
	border-bottom:1px solid #C0C0C0;
}

td.linha_campo a {
    text-decoration:none;
    color: #FF0000;
    color: #1E1E1E;
    font-weight:bold;
}

td.linha_campo a:hover {
    color:#A80000;
    font-weight:bold;
}



td.linha_campo_r {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 20px;
	border-bottom:1px solid #C0C0C0;
	background:#FFCACA;
}

td.linha_campo_r a {
    text-decoration:none;
    color: #000000;
    font-weight:bold;
}

td.linha_campo_r a:hover {
    color:#A80000;
    font-weight:bold;
}


td.linha_campo_a {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 20px;
	border-bottom:1px solid #C0C0C0;
	background:#A2A2A2;
	color: #FFFFFF;
    font-weight:bold;
}

td.linha_campo_a a {
    text-decoration:none;
    color: #FFFFFF;
    font-weight:bold;
}

td.linha_campo_a a:hover {
    color:#A80000;
    font-weight:bold;
}


td.linha_campo_pt {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 4px;
	padding-left: 4px;
	background:#F8F8F8;
	text-align:left   ;
	border-bottom:1px solid #C0C0C0;
}



td.linha_campo_p {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
	padding-right: 4px;
	padding-left: 4px;
	sborder-bottom:1px solid #C0C0C0;
	background:#FFFFFF;
	text-align:right   ;
	border-bottom:1px solid #C0C0C0;
}

td.linha_campo_p a {
    text-decoration:none;
    color: #000000;
    font-weight:bold;
}

td.linha_campo_p a:hover {
    color:#A80000;
    font-weight:bold;
}








tr.linha_lista_t {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 13px;
	color: #808080;
	font-weight:bold;
	text-align: right;
	border-collapse: collapse;
	background-color: #FFDDDD;
	background-color: #F0F0F0;

}

td.linha_campo_t {
	border-collapse: collapse;
	padding-top:5px;
	padding-bottom:5px;
 	padding-right: 20px;
	border-bottom:1px solid #FFD2D2;
}


td.linha_campo_t a {
    text-decoration:none;
    color: #FF0000;
    color: #1E1E1E;
    font-weight:bold;
}

td.linha_campo_t a:hover {
    color:#A80000;
    font-weight:bold;
}



table.tabela_navegacao {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 16px;
	font-weight:bold;
	color: #F7F7F7;
	padding-left:10px;
	text-align: center;
	border-collapse: collapse;
	sbackground: #EBEBEB url(imagens/rodape_lista.jpg) repeat ;
	margin-bottom:3px;
}


tr.navegacao_lista_1 {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;
	color: #373737;
	font-weight:bold;
    text-align: center;
	border-collapse: collapse;
	sbackground: #EBEBEB url(imagens/rodape_lista.jpg) repeat ;
	background: #E4E4E4;
	sheight:3px;
	margin-bottom:13px;

}

tr.navegacao_lista_2 {
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;
	color: #373737;
	font-weight:bold;
    text-align: center;
	border-collapse: collapse;
	sbackground: #EBEBEB url(imagens/rodape_lista.jpg) repeat ;
	background: #F4F4F4;
	sheight:3px;
	margin-bottom:13px;
}


td.navegacao_campo {
    padding-top:2px;
	padding-bottom:2px;
	padding-right: 20px;
	margin-bottom:13px;
    swidth:10px;
    cursor:pointer;
}

td.navegacao_campo:hover {
    color: #B70000;
}


.bt_topo_barra {
   background:#900000;
   smargin-top:4px;
   padding-top:5px;
   height:35px;
   width:130px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
}


div#topo_barra1 .bt_topo_barra a {


   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 14px;
   color    : #FFFFFF;
   font-weight:bold;
   text-decoration:none;


}
div#topo_barra1 .bt_topo_barra:hover {
    background:#C0C0C0;
    color:#900000;
}
div#topo_barra1 .bt_topo_barra a:hover {
    background:#C0C0C0;
    color:#900000;
}

div#condicionantes {
   margin-bottom:15px;
   background: #EFEFEF;
   width:100%;
   display:none;
}


div#barra_condicionantes {
   background:#5B0000;
   height:35px;
   width:100%;
   display:block;
   padding-top:5px;
   spadding-left:20px;
   margin-bottom:5px;
   display:block;

}

div#barra_condicionantes a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:bold;
   margin-left:20px;
}


div#residuos {
   margin-bottom:15px;
   background:#FFFFFF;
   width:100%;
   display:block;
}
div#residuos a{
   text-decoration:none;
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #900000;
   font-weight:bold;
   margin-left:20px;

}

div#barra_residuos {
   background:#5B0000;
   height:35px;
   width:100%;
   display:block;
   padding-top:5px;
   spadding-left:20px;
   margin-bottom:5px;

}

div#barra_residuos a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:bold;
   margin-left:20px;
}


div#area_vivencia {
   margin-bottom:15px;
   background: #EFEFEF;
   width:100%;
   display:none;
}


div#barra_area_vivencia {
   background:#5B0000;
   height:35px;
   width:100%;
   display:block;
   padding-top:5px;
   spadding-left:20px;
   margin-bottom:5px;
   display:block;

}

div#barra_area_vivencia a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:bold;
   margin-left:20px;
}

div#tabela_det_residuos {
   background:#C0C0C0;
   display:none;
}

div#classe_legenda  {
   background:#F5F5F5;
   smargin-left:20px;
   display:none;
   padding-left:20px;

}

div#classe_legenda span {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 10px;
   color    : #000000;
   font-weight:bold;
   spadding-left:20px;
}


div#barra_indicadores {
   smargin-left:20px;
   background:#808080;
   border-top:#000000;
   border-bottom:#000000;
   margin-top:10px;
   width:100%;
   text-align:left;

   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}
div#barra_indicadores a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}



div#barra_indicadores_1 {
   smargin-left:20px;
   background:#808080;
   border-top:#000000;
   border-bottom:#000000;
   margin-top:10px;
   width:100%;
   text-align:left;

   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}
div#barra_indicadores_1 a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;
}


div#barra_indicadores_3 {
   smargin-left:20px;
   background:#808080;
   border-top:#000000;
   border-bottom:#000000;
   margin-top:10px;
   width:100%;
   text-align:left;

   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}
div#barra_indicadores_3 a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;
}

div#barra_indicadores_4 {
   smargin-left:20px;
   background:#808080;
   border-top:#000000;
   border-bottom:#000000;
   margin-top:10px;
   width:100%;
   text-align:left;

   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}
div#barra_indicadores_4 a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;
}

div#barra_indicadores_5 {
   smargin-left:20px;
   background:#808080;
   border-top:#000000;
   border-bottom:#000000;
   margin-top:10px;
   width:100%;
   text-align:left;

   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;


}
div#barra_indicadores_5 a {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight:normal;
   font-weight:bold;
}


div#barra_sp {
   background:#808080;
   margin-top:2px;
   width:100%;
   height:1px;
   display:block;
}
div.erro  {
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 16px;
   color    : #FFFFFF;
   font-weight: bold;
   margin-left:20px;
   background:#FF0000;
   text-align:center;

}

    select#tipo_acidente {
        width:145px;
        background:#900000;
        color:#FFFFFF;
        font-weight: bold;
        font-family: Calibri, Arial, Helvetica, sans-serif;
        font-size: 14px;

    }


div#assinatura_controle {
        font-family: Calibri, Arial, Helvetica, sans-serif;
        margin-left:20px;

}
tr.linha_cab_tabela_pa {
 	background: #600000;
	font-weight: bold;
	text-align: center;
	border: 0px solid #840000;
	border-collapse: collapse;
	padding: 2px;
	color:#FFFFFF;
    font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 12px;

}

td.linha_tabela_pa {
	background: #DDDDDD;
	border-bottom: 1px solid #666666;
	border-collapse: collapse;
	padding: 4px;
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 11px;
	color: #151515;
	text-align: right;
}

td.linha_tabela_pa_d {
	background: #F2F2F2;
	font-weight: normal;
 border-bottom: 1px solid #666666;
	border-collapse: collapse;
	padding: 4px;
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 11px;
	color: #A7A7A7;
	text-align: right;
}

td.linha_tabela_pa_l {
	background: #F2F2F2;
	font-weight: normal;
 border-bottom: 1px solid #666666;
	border-collapse: collapse;
	padding: 4px;
	font-family: Calibri, Arial, Helvetica, sans-serif;
	font-size: 11px;
    color:#000000;
	text-align: center;
}

.bt_topo_barra_acon {
   background:#900000;
   padding-top:5px;
   height:35px;
   width:150px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
}
.bt_topo_barra_estado {
   background:#900000;
   padding-top:5px;
   height:35px;
   width:150px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
}
.bt_topo_barra_ggc {
   background:#900000;
   padding-top:5px;
   height:35px;
   width:150px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
}
.bt_topo_barra_exe {
   background:#900000;
   padding-top:5px;
   height:35px;
   width:150px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
}

.bt_topo_barra_msg {
   background:#000000;
   padding-top:5px;
   height:35px;
   width:200px;
   float:left;
   border-right:1px solid #FFFFFF;
   border-left:1px solid #FFFFFF;
   text-align:center;
   display:none;
   color:#FFFFFF;
   font-size:16px;
   font-weight: bold;
}

div#topo_barra1 {
   spadding-left:30px;
   margin-bottom:5px;
   background:#900000;
   height:40px;
   width:100%;
}
div#topo_barra2 {
   spadding-left:30px;
   margin-bottom:5px;
   background:red;
   height:40px;
   width:100%;
}

div#topo_barra3 {
   margin-bottom:5px;
   background:#FFFFFF;
   border-bottom: 3px solid #C0C0C0;
   text-align:center;
   height:40px;
   width:100%;
   
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 18px;
   font-weight:bold;
   color: #600000;
}
div#topo_barra_msg_sem {
   margin-bottom:5px;

   background:red;
   border-top: 3px solid #C0C0C0;
   border-bottom: 3px solid #C0C0C0;
   text-align:center;
   height:40px;
   width:99%;
   font-family: Calibri, Arial, Helvetica, sans-serif;
   font-size: 20px;
   font-weight:bold;
   color: #FFFFFF;
}

div#lista_assinantes {
   display:none;
}


    .Menu_print_ass {
        background:#FFFFFF;
        width: 100%;
        font-family : Calibri, Arial, Helvetica, sans-serif;
        sfont-size: 14px;
        font-style: normal;
        font-weight: bold;
        scolor: #313131;
    }


</style>

<?php

$ggc_idt                 = $_REQUEST['ggc_idt'];
$es_estado               = $_REQUEST['es_estado'];
$idt_assinatura_controle = $_REQUEST['idt_assinatura_controle'];


$ggc_idt                 = $_REQUEST['ggc_idt'];
$es_estado               = $_REQUEST['es_estado'];
$idt_assinatura_controle = $_REQUEST['idt_assinatura_controle'];




                    $vmesnum = Array();
                    $vmesnum['01'] = 'Janeiro';
                    $vmesnum['02'] = 'Fevereiro';
                    $vmesnum['03'] = 'Março';
                    $vmesnum['04'] = 'Abril';
                    $vmesnum['05'] = 'Maio';
                    $vmesnum['06'] = 'Junho';
                    $vmesnum['07'] = 'Julho';
                    $vmesnum['08'] = 'Agôsto';
                    $vmesnum['09'] = 'Setembro';
                    $vmesnum['10'] = 'Outubro';
                    $vmesnum['11'] = 'Novembro';
                    $vmesnum['12'] = 'Dezembro';

$ac_data     = '';
$ac_data_ref = '';


$estado = $es_estado;

$sql   = 'select idt, dia, mes, ano from assina_controle';
$sql  .= ' where idt = '.null($idt_assinatura_controle);
$sql  .= ' order by ano desc, mes desc, dia desc';
$rs = execsql($sql);
if  ($rs->rows==0)
{
}
else
{
     ForEach($rs->data as $row) {
        $ac_data = $row['dia'].'/'.$row['mes'].'/'.$row['ano'];
        $ac_data_ref =  $vmesnum[$row['mes']].'/'.$row['ano'];

     }
}

$titulo_rel     ='RELATÓRIO DE MONITORAMENTO DE ATUALIZAÇÃO';
$subtitulo_rel  ='';
$subtitulo_rel .="<span style='font-size:12px; ' >";
$subtitulo_rel .='<br />'.date('d/m/Y').' '.(date('H') - date('I')).':'.date('i');
$subtitulo_rel .='<br />Emitido por:&nbsp;'.$_SESSION[CS]['g_nome_completo'];
$subtitulo_rel .="</span>";





$vetObras=Array();
$vetGGCObras=Array();
$vetGeralGGC=Array();
$vetFassina=Array();
$vetNatrizObraAss=Array();
$idt_controle_assinatura=null($idt_assinatura_controle);
$ret=carregar_matriz_obra_funcao($idt_controle_assinatura,$vetObras,$vetGGCObras,$vetGeralObra,$vetGeralGGC,$vetGGC,$vetFassina,$vetNatrizObraAss);

$Vopcao_obras=Array();
$obras_escolhidas='';
if ($ggc_idt!='')
{
    $obras_escolhidas=$vetGGCObras[$ggc_idt];
    if ($estado!='')
    {
       // considerar estado
       $Vopcao_obras_ggc=explode('#',$obras_escolhidas);
       $obras_escolhidas='';
       $sep='';
       ForEach ($vetObras as $idxo => $Vet_o)
       {
            $em_estado = $Vet_o['em_estado'];
            if ($estado==$em_estado)
            {
                $em_idt = $Vet_o['em_idt'];
                ForEach ($Vopcao_obras_ggc as $idxo => $idt_obraggc)
                {
       //             p($idt_obraggc);
                    if  ($idt_obraggc==$em_idt)
                    {
                         $obras_escolhidas=$obras_escolhidas.$sep.$idt_obraggc;
                         $sep='#';
                    }
                }
            }
       }
    }
}
if  ($obras_escolhidas=='')
{
     if ($ggc_idt!='')
     {
         $opcao_obras='E';
         $Vopcao_obras=Array();
         exit();
         
     }
     else
     {
         $opcao_obras='T';
     }
}
else
{
     $opcao_obras='E';
     $Vopcao_obras=explode('#',$obras_escolhidas);
}
$Vopcao_obras_idt=Array();
ForEach ($Vopcao_obras as $idxo => $idt)
{
   $Vopcao_obras_idt[$idt]=$idt;
}

   $tam = count($vetObras)+1;
   if ($estado!='-1')
   {
       $tam = 1;
       ForEach ($vetObras as $idxo => $Vet_o)
       {
            $em_estado = $Vet_o['em_estado'];
            if ($estado==$em_estado)
            {
                $tam = $tam+1;
            }
       }
   }

   if ($opcao_obras=='E')
   {
       $tam = count($Vopcao_obras)+1;
   }

$url_site   = $vetConf['url_site'];
$ref_atu= 'Atualização referente a '.$ac_data_ref;
$path = $url_site.'admin/obj_file/empreendimento/';


echo "<table class='Geral_pa' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";



echo "<tr class='linha_cab_tabela_pa' style=' height:140px; background:#FFFFFF;' >  ";
      $sp=($tam-3);
//      echo "   <td colspan='{$sp}' style='width:99%;  display:block; background:#FF8040;' >";
      echo "   <td  colspan='{$sp}' style='width:60%;  background:#FFFFFF;' >";
                    echo '     <img style=" float:left; padding:5px;" src="'.$url_site.'admin/imagens/logo_PCO.jpg" width="148" height="113" alt="Logo do sistema PCO" border="0" />';
      echo "   </td> ";
     
      echo "   <td colspan='3' style='width:40%; background:#FFFFFF;' >";
                    $caminho = $url_site.'admin/imagens/logo_oas_empreendimentos.jpg';
                    $imgw = '<img   style="padding_left:40px; " src="'.$caminho.'"  title="'.'Logo do oas empreendimentos'.'" alt="'.'Logo do oas empreendimentos'.'"  border="0" />';

                    echo '<span style=" color:#666666; " >';
                    echo $imgw;
                    echo '<br/><br/>'.date('d/m/Y').' '.(date('H') - date('I')).':'.date('i');
                    echo '<br/>Usuário:&nbsp;'.$_SESSION[CS]['g_nome_completo'];


                    echo '</span>';
      echo "   </td> ";


     
echo "</tr>";







echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF;' >  ";
    $sp=($tam);
    echo "   <td style='  font-size:18px; background:#600000;' colspan='{$sp}' >{$titulo_rel}$tam<br /><span style='width:8%; font-size:14px;' >{$subtitulo_rel}</span></td> ";

echo "</tr>";



//echo "</table>";
//echo "</div>";
//exit();


echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF;' >  ";

echo "   <td style='border-bottom:1px solid #666666; width:20%; color:#0080C0; font-weight: bold; font-size: 14px;' >$ref_atu</td> ";
ForEach ($vetObras as $idx => $Vet)
{

     $nome_obra = $Vet['em_descricao'].'<br>'.$Vet['em_estado'];
     if ($opcao_obras=='E')
     {
         $em_idt = $Vet['em_idt'];
         //p( ' aaaa '.$em_idt. ' bbbb '.$Vopcao_obras_idt[$em_idt]);
         if ($em_idt==$Vopcao_obras_idt[$em_idt])
         {
              echo "   <td style='background:#FFFFFF; width:8%; border-bottom:1px solid #666666;' >";
                       echo '<div class="sempreendimento_l">';
                       $caminho=$path.$Vet['em_imagem'];
                       $imgw = '<img width="60" height="50" style="padding:5px;" src="'.$caminho.'"  title="'.$Vet['em_descricao'].'" alt="'.$Vet['em_descricao'].'"  border="0" />';
                    //   ImagemMostrar(80, 0, $path, $Vet['em_imagem'], $Vet['em_descricao'], false, 'idt="'.$Vet['em_idt'].'"');
                       echo $imgw;
                       echo '</div>';
               echo "   </td> ";
         }
         else
         {
             continue;
         }
     }
     else
     {
         if ($estado=='-1')
         {
//             echo "   <td style='width:8%;' >$nome_obra</td> ";
              echo "   <td style='background:#FFFFFF; width:8%; border-bottom:1px solid #666666;' >";
                        echo '<div class="sempreendimento_l">';
                        //ImagemMostrar(80, 0, $path, $Vet['em_imagem'], $Vet['em_descricao'], false, 'idt="'.$Vet['em_idt'].'"');
                        $caminho=$path.$Vet['em_imagem'];
                        $imgw = '<img width="60" height="50" style="padding:5px;" src="'.$caminho.'"  title="'.$Vet['em_descricao'].'" alt="'.$Vet['em_descricao'].'"  border="0" />';
                    //   ImagemMostrar(80, 0, $path, $Vet['em_imagem'], $Vet['em_descricao'], false, 'idt="'.$Vet['em_idt'].'"');
                       echo $imgw;
                        echo '</div>';
               echo "   </td> ";

         }
         else
         {
             if ($estado==$Vet['em_estado'])
             {
  //               echo "   <td style='width:8%;' >$nome_obra</td> ";
                echo "   <td style='background:#FFFFFF;  width:8%; border-bottom:1px solid #666666;' >";
                       echo '<div class="sempreendimento_l">';
                        $caminho=$path.$Vet['em_imagem'];
                        $imgw = '<img width="60" height="50" style="padding:5px;" src="'.$caminho.'"  title="'.$Vet['em_descricao'].'" alt="'.$Vet['em_descricao'].'"  border="0" />';
                    //   ImagemMostrar(80, 0, $path, $Vet['em_imagem'], $Vet['em_descricao'], false, 'idt="'.$Vet['em_idt'].'"');
                       echo $imgw;
                       echo '</div>';
               echo "   </td> ";

             }
         }
     }
}
echo "</tr>";
echo "<tr class='linha_cab_tabela_pa'  style='background:#FFFFFF; color:#666666;' >  ";

// GGC da obra
echo "   <td style='background:#C0C0C0; border-bottom:1px solid #666666; width:20%; color:#0080C0; text-align:right; font-weight: bold; font-size: 12px;' >GGC</td> ";

//p($vetObras);




$path = $dir_file.'/ggc/';


$colspantotal=0;

ForEach ($vetObras as $idx => $Vet)
{

     $ggc_nome_resumo = $Vet['ggc_nome_resumo'];
     if ($ggc_nome_resumo=='')
     {
         $ggc_nome_resumo='Sem GGC Inf.';
     }
     if ($opcao_obras=='E')
     {
         $em_idt = $Vet['em_idt'];
 //        p( ' aaaa '.$em_idt. ' bbbb '.$Vopcao_obras_idt[$em_idt].' nnnn '.$ggc_nome_resumo);
         if ($em_idt==$Vopcao_obras_idt[$em_idt])
         {
                       if ($Vet['ggc_imagem']!='')
                       {
                           echo "   <td style='border-bottom:1px solid #666666; width:8%;' >";
                           echo '<div class="empreendimento_l">';
                           ImagemMostrar(80, 0, $path, $Vet['ggc_imagem'], $Vet['ggc_nome_resumo'], false, 'idt="'.$Vet['ggc_idt'].'"');
                           echo '</div>';
                           echo "   </td> ";
                           $vetidtGGC[]=$Vet['ggc_idt'];
                       }
                       else
                       {
                            echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%;  text-align:center;' >{$ggc_nome_resumo}</td> ";
                            $vetidtGGC[]=$Vet['ggc_idt'];
                       }
               $colspantotal=$colspantotal+1;
         }
         else
         {
             continue;
         }
     }
     else
     {
         if ($estado=='-1')
         {
                       if ($Vet['ggc_imagem']!='')
                       {
                           echo "   <td style='border-bottom:1px solid #666666; width:8%;' >";
                           echo '<div class="empreendimento_l">';
                           ImagemMostrar(80, 0, $path, $Vet['ggc_imagem'], $Vet['ggc_nome_resumo'], false, 'idt="'.$Vet['ggc_idt'].'"');
                           echo '</div>';
                           echo "   </td> ";
                           $vetidtGGC[]=$Vet['ggc_idt'];
                       }
                       else
                       {
                            echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%;  text-align:center;' >{$ggc_nome_resumo}</td> ";
                            $vetidtGGC[]=$Vet['ggc_idt'];
                       }
                       $colspantotal=$colspantotal+1;

         }
         else
         {
             if ($estado==$Vet['em_estado'])
             {
                       if ($Vet['ggc_imagem']!='')
                       {
                           echo "   <td style='border-bottom:1px solid #666666; width:8%;' >";
                           echo '<div class="empreendimento_l">';
                           ImagemMostrar(80, 0, $path, $Vet['ggc_imagem'], $Vet['ggc_nome_resumo'], false, 'idt="'.$Vet['ggc_idt'].'"');
                           echo '</div>';
                           echo "   </td> ";
                           $vetidtGGC[]=$Vet['ggc_idt'];
                       }
                       else
                       {
                            echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%;  text-align:center;' >{$ggc_nome_resumo}</td> ";
                            $vetidtGGC[]=$Vet['ggc_idt'];
                       }
                       $colspantotal=$colspantotal+1;

             }
         }
     }
}
echo "</tr>";


echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF; color:#666666;' >  ";

//p(' bbbbbbb '.$opcao_obras);
// % de assinatura
echo "   <td style='background:#C0C0C0; border-bottom:1px solid #666666; width:20%; color:#0080C0; text-align:right; font-weight: bold; font-size: 12px;' >% ATUALIZAÇÃO OBRA</td> ";


ForEach ($vetObras as $idx => $Vet)
{
      ForEach ($vetGeralObra as $idt_obra => $Vetqtd)
      {
          if ($Vet['em_idt']==$idt_obra)
          {
              $geral       = $Vetqtd['geral'];
              $assinado    = $Vetqtd['assinado'];
              $naoassinado = $Vetqtd['naoassinado'];
              $naoaplica   = $Vetqtd['naoaplica'];
              $totalparaassinar = $assinado+$naoassinado;
              $percassinados=0;
              if ($totalparaassinar>0)
              {
                  $percassinados    = ($assinado/$totalparaassinar)*100;
              }
          }
     }
     $nome_obra = $Vet['em_descricao'].'<br>'.$Vet['em_estado'];
     if ($opcao_obras=='E')
     {
         $em_idt = $Vet['em_idt'];
         //p( ' aaaa '.$em_idt. ' bbbb '.$Vopcao_obras_idt[$em_idt]);
         if ($em_idt==$Vopcao_obras_idt[$em_idt])
         {
             $percent_total_ggc = format_decimal($percassinados);
              echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%;  text-align:center;' >{$percent_total_ggc}%</td> ";
         }
         else
         {
             continue;
         }
     }
     else
     {
         if ($estado=='-1')
         {
             $percent_total_ggc = format_decimal($percassinados);
              echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%;  text-align:center;' >{$percent_total_ggc}%</td> ";
         }
         else
         {
             if ($estado==$Vet['em_estado'])
             {
              $percent_total_ggc = format_decimal($percassinados);
              echo "   <td style='background:#FFFFFF; border-bottom:1px solid #666666; width:8%; text-align:center;' >{$percent_total_ggc}%</td> ";

             }
         }
     }
}
echo "</tr>";


// % geral do ggc
$vetGGCperc=Array();
ForEach ($vetGGC as $idt_ggc => $VetpercGGC)
{
   $assinado     =  $VetpercGGC['assinado'];
   $naoassinado  =  $VetpercGGC['naoassinado'];
   $total        =  $assinado+$naoassinado;
   $perc         =  0;
   if ($total>0)
   {
       $perc =($assinado/$total)*100;
   }
   $vetGGCperc[$idt_ggc]=$perc;
}


echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF; color:#666666;' >  ";
echo "   <td style='background:#C0C0C0; border-bottom:1px solid #666666; width:20%; color:#0080C0; text-align:right; font-weight: bold; font-size: 12px;' >% GGC</td> ";
$igccant=0;
ForEach ($vetidtGGC as $ix => $idt_ggc)
{
    if ($igccant!=$idt_ggc)
    {
        $perc=$vetGGCperc[$idt_ggc];
        $percent_total_ggc = format_decimal($perc);
        $igccant=$idt_ggc;
    }
    else
    {
        $percent_total_ggc = '&nbsp;';
    }
    echo "   <td style='background:#FFFFFF;border-bottom:1px solid #666666; width:8%; text-align:center;' >{$percent_total_ggc}</td> ";
}
echo "</tr>";


echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF;' >  ";
    $sp=($colspantotal);
    echo "   <td style=' width:8%;' colspan='{$sp}' >&nbsp;</td> ";
echo "</tr>";



echo "<tr class='linha_cab_tabela_pa' style='background:#FFFFFF;' >  ";
echo "   <td style='width:20%;' >Ítem</td> ";

//p($Vopcao_obras_idt);

//p(' bbbbbbb '.$opcao_obras);


ForEach ($vetObras as $idx => $Vet)
{

     $nome_obra = $Vet['em_descricao'].'<br>'.$Vet['em_estado'];
     if ($opcao_obras=='E')
     {
         $em_idt = $Vet['em_idt'];
         //p( ' aaaa '.$em_idt. ' bbbb '.$Vopcao_obras_idt[$em_idt]);
         if ($em_idt==$Vopcao_obras_idt[$em_idt])
         {
              echo "   <td style='width:8%;' >$nome_obra</td> ";
         }
         else
         {
             continue;
         }
     }
     else
     {
         if ($estado=='-1')
         {
             echo "   <td style='width:8%;' >$nome_obra</td> ";
         }
         else
         {
             if ($estado==$Vet['em_estado'])
             {
                 echo "   <td style='width:8%;' >$nome_obra</td> ";
             }
         }
     }
}
echo "</tr>";

$itgrupo=0;
$itele = 0;
ForEach ($vetNatrizObraAss as $idx => $Vet)
{
   $vet_func=$Vet['func'];
   $vet_obra=$Vet['obra'];
   // monta função;
   $sf_idt        = $vet_func['sf_idt'];
   $sf_nm_funcao  = $vet_func['sf_nm_funcao'];
   $sf_assinatura = $vet_func['sf_assinatura'];
   $sf_cod_classificacao =  $vet_func['sf_cod_classificacao'];

   $tam   = strlen($sf_cod_classificacao);
   $des   = str_repeat('&nbsp;', (($tam-2)*1) );
   $nivel = ($tam/2);

   $bgi='';
   $cli='#000000';

   if ($nivel==1)
   {
       $itgrupo=$itgrupo+1;
       $des = $des.'&nbsp;&nbsp;'.$itgrupo.' - '.mb_strtoupper($sf_nm_funcao);
       $itele = 0;
       $bgi='#C0C0C0;';
   }
   else
   {
       $itele=$itele+1;
       $des = $des.$itele.' - '.$sf_nm_funcao;
       $bgi='#FFFFFF;';
   }

   echo "<tr class= 'linha_tabela_pa' >";
   echo "<td class='linha_tabela_pa_l' style='font-weight: bold; background:{$bgi}; width:30%; color:{$cli}; text-align:left;'>{$des}</td>";
   // monta colunas
   ForEach ($vet_obra as $idxo => $Vet_o)

   {
        $em_idt    = $Vet_o['em_idt'];
        $em_estado = $Vet_o['em_estado'];
        $ativo     = $Vet_o['ativo'];
        $assina    = $Vet_o['assina'];
        $data      = $Vet_o['data'];
        $versao    = $Vet_o['versao'];
        $assinante = $Vet_o['assinante'];


        if ($opcao_obras=='E')
        {
            if ($em_idt!=$Vopcao_obras_idt[$em_idt])
            {
                continue;
            }
        }

        $colw  = '';
       // $colw  .= $ativo.'<br>';
       // $colw .= $assina.'<br>';



        $bg='#FFFFFF';
        $cc='#000000';
        if  ($assina=='S')
        {   // assinado verde
            //$bg='#00FF40';
            //$colw .= $assinante.' - '.$data.' - '.$versao.'<br>';
            $colw .= '&radic;';
        }
        else
        {
            if  ($ativo=='S')
            {   // ativo e não assinado vermelho
              //  $bg='#FF0000';
                $cc='#FF0000';
                $colw .= '&Chi;';
            }
            else
            {   // não ativo amarelo
              //  $bg='#FFFF80';
                $colw .= 'N/A';
            }
        }
        if ($nivel==1)
        {
            $bg='#C0C0C0';

            if  ($ativo!='S')
            {   // ativo e não assinado vermelho
                $colw = '&nbsp;';
                $cc='#000000';
            }
            else
            {

            }
        }
        
        
        
        if ($opcao_obras=='E')
        {
            echo "<td class='linha_tabela_pa_l' style='background:{$bg}; color:{$cc}; ' >".$colw."</td>";
        }
        else
        {
            if ($estado=='-1')
            {
                echo "<td class='linha_tabela_pa_l' style='background:{$bg}; color:{$cc}; ' >".$colw."</td>";
            }
            else
            {
                if ($estado==$em_estado)
                {
                    echo "<td class='linha_tabela_pa_l' style='background:{$bg}; color:{$cc}; ' >".$colw."</td>";
                }
            }
        }
   }
   echo "</tr>";
}
echo "</table>";

?>
