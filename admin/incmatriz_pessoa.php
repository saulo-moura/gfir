
<style type="text/css">


div#contrato {
    soverflow:auto;
    sheight: 380px;
    swidth : 680px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    background: #FFFFFF;
    margin-top:0px;
}


div#contrato_1 {
    soverflow:auto;
    sheight: 360px;
    width : 670px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    padding:0px;
    background: #FFFFFF;
}


table.contrato_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EFEFEF;
    background: #A2A2A2;
}

tr.contrato_table_tr {


}
td.contrato_titulo_td {
    font-weight : bold;
    color       : #FFFFFF;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
}
tr.contrato_cab_tr {

}
td.contrato_cab_td {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #666666;
}

td.contrato_cab_td_r {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
    text-align: right;
}

tr.contrato_linha_tr {

}
td.contrato_linha_td_t {
    font-weight   : normal;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t1 {
    font-weight   : normal;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t2 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t3 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}


td.contrato_linha_td_t_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t1_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t2_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t3_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}



td.contrato_linha_td_a {
    font-weight :normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_a_r {
    font-weight : normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_a_r a {
    font-weight : bold;
    color       :#900000;
    text-decoration:none;
}

div#contrato_c {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    height:10px;
    margin:0px;
}

div#contrato_r {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    sheight:10px;
    margin:0px;
    float:left;
    padding-bottom:20px;
}


.quantidade_contrato {
    background:#E9E9E9;
    swidth : 100%;
    font-family :  Arial, Calibri, Helvetica, sans-serif;
    font-style: normal;
    font-size: 14px;
    font-weight: bold;
    color:#666666;

}


div#mostra_aditivo {
    position:absolute;
    
    left:240px;
    top:150px;
    
    width :700px;
    height:200px;
    
    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#mostra_aditivo img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#mostra_aditivo_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#mostra_aditivo_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#mostra_aditivo_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}

td.cabecalho_campo {
   color: #FFFFFF;
   font-weight: bold;
   padding-bottom:10px;
   border-bottom:1px;
   background:#808080;

}
td.linha_campo {
   color: #202020;
}


div#posicao_periodo {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Arial, Calibri,  Helvetica,  sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda {
    width : 670px;
    width : 100%;
    height: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda_l {
    font-size: 11px;
    color:#000000;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}


div#legenda_i {
    font-size: 11px;
    color:#858585;
    sfloat:left;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}
div#legenda_i img {
    color:#858585;
    font-weight: bold;
}
div#legenda_i span {
    color:#858585;
    font-weight: bold;
}


table.legenda_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EAEAEA;
}

tr.legenda_cab_tr {


}
td.legenda_cab_td {
    font-weight : bold;
    color       : #B9B9B9;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom: 1px solid #000000;
}


div#legenda_maior {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}




div#contrato_edoc {
    position:absolute;

    left:240px;
    top:150px;

    width :700px;
    height:200px;

    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#contrato_edoc img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#contrato_edoc_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#contrato_edoc_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#contrato_edoc_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}


div#voltar_full_m  {
    float:left;
    height:25px;
    background:transparent;
    sbackground:red;
    margin:0px;
    padding:0px;
}

div#voltar_full_m img {
    cursor: pointer;
}

.voltar  {
    float:left;
}


div#area_imprime {
    float:left;
    background: #FFFFFF;
    text-align:right;
    background:blue;

}
div#area_imprime img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_excel {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_excel img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_doc {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_doc img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}


</style>


<?php
$id               = $_GET['id'];
$idt_organizacao  = $id;
$sqll   = 'select ';
$sqll  .= '  sca_eo.* ';
$sqll  .= '  from  sca_estrutura_organizacional sca_eo ';
$sqll  .= '  inner join sca_organizacao_secao  sca_os on sca_os.idt_organizacao = sca_eo.idt  ';
$sqll  .= '  inner join sca_organizacao_pessoa sca_op on sca_op.idt_secao = sca_os.idt  ';
$sqll  .= '  where sca_eo.idt = '.null($idt_organizacao);
$rsl    = execsql($sqll);
$qtd_funcionarios=0;
ForEach($rsl->data as $rowl)
{
    $qtd_funcionarios = $qtd_funcionarios + 1;
}

$sqll   = 'select ';
$sqll  .= '  sca_eo.*, ';
$sqll  .= '  sca_os.codigo    as sca_os_codigo, ';
$sqll  .= '  sca_os.descricao as sca_os_descricao, ';
$sqll  .= '  sca_op.codigo    as sca_op_codigo, ';
$sqll  .= '  sca_op.nome      as sca_op_nome, ';
$sqll  .= '  sca_ca.codigo    as sca_ca_codigo, ';
$sqll  .= '  sca_ca.descricao as sca_ca_descricao ';
//
$sqll  .= '  from  sca_estrutura_organizacional sca_eo ';
$sqll  .= '  inner join sca_organizacao_secao  sca_os on sca_os.idt_organizacao = sca_eo.idt  ';
$sqll  .= '  left  join sca_organizacao_pessoa sca_op on sca_op.idt_secao = sca_os.idt  ';
$sqll  .= '  left join sca_organizacao_cargo sca_ca on sca_ca.idt = sca_op.idt_cargo  ';

$sqll  .= '  where sca_eo.idt = '.null($idt_organizacao);


$sqll  .= '  order by sca_os.classificacao, sca_ca.descricao ';
$rsl    = execsql($sqll);
$vetDepto            = Array();
$vetCargo            = Array();
$vetDeptoNom         = Array();
$vetDeptoc           = Array();
$vetCargoc           = Array();
$vetCustoDepto       = Array();
$vetCustoDeptoCargo  = Array();

$vetGrafico_1  = Array();
$vetGrafico_2  = Array();

$vetSecaoCargoProcessoPessoas = Array();
$vetPessoas = Array();


$totalgeral=0;
$custogeral=0;
ForEach($rsl->data as $rowl)
{
    $codigo_secao        = $rowl['sca_os_codigo'];
    $setor_unidade       = $rowl['sca_os_descricao'];
    $vetDeptoNom[$codigo_secao]  = $setor_unidade;
    $sca_op_codigo       = $rowl['sca_op_codigo'];
    $nom_funcionario     = $rowl['sca_op_nome'];
    $cargo               = $rowl['sca_ca_descricao'];
    $cargo_co            = $rowl['sca_ca_codigo'];
    $qtdcolab            = $vetDepto[$codigo_secao][$cargo];
    
    $vetDeptoc[$codigo_secao] = $vetDeptoc[$codigo_secao]+1;
    
    $salario_base        = $rowl['salario_base'];
    $salario_base        = 1;
    
    $vetCustoDepto[$codigo_secao]               = $vetCustoDepto[$codigo_secao] + $salario_base;
    $vetCustoDeptoCargo[$codigo_secao][$cargo]  = $vetCustoDeptoCargo[$codigo_secao][$cargo] + $salario_base;

    $vetPessoas[$sca_op_codigo]=$nom_funcionario;
    $vetSecaoCargoProcessoPessoas[$codigo_secao][$cargo][$sca_op_codigo]=$nom_funcionario;
    
    
    if ($qtdcolab=="")
    {
        $vetDepto[$codigo_secao][$cargo]=1;
    }
    else
    {
        $vetDepto[$codigo_secao][$cargo]=$vetDepto[$codigo_secao][$cargo]+1;
    }
    
    $qtdcolabc    = $vetCargo[$cargo][$codigo_secao];
    $vetCargoc[$cargo] = $vetCargoc[$cargo]+1;
    
    $vetCargoco[$cargo_co] = $vetCargoco[$cargo]+1;
    
    if ($qtdcolabc=="")
    {
        $vetCargo[$cargo][$codigo_secao]=1;
    }
    else
    {
        $vetCargo[$cargo][$codigo_secao]=$vetCargo[$cargo][$codigo_secao]+1;
    }

    
    $totalgeral=$totalgeral+1;
    $custogeral=$custogeral+$salario_base;
}

$custogeralw=format_decimal($custogeral);
$totalgeralw=format_decimal($totalgeral,0);

//p($vetCustoDepto);

ForEach ($vetCustoDepto as $codigo_secao => $Custo) {
    $sqllw   = 'select ';
    $sqllw  .= '  sca_os.* ';
    $sqllw  .= '  from  sca_organizacao_secao  sca_os ';
    $sqllw  .= '  where sca_os.idt_organizacao  = '.null($idt_organizacao);
    $sqllw  .= '   and sca_os.codigo            = '.aspa($codigo_secao);
    $rslw    = execsql($sqllw);
    $descricao_secao = "";
    ForEach($rslw->data as $rowlw)
    {
        $descricao_secao        = $rowlw['descricao'];
    }
    
    if (substr($codigo_secao,0,2)=="99")
    {
        $codigo_secao    = "9999999";
        $descricao_secao = "CEDIDO A OUTROS ORGÃOS";
        
    }

    if ($custogeral==0)
    {
        $custoperc =  0;
    }
    else
    {
        $custoperc = ( $Custo/$custogeral ) * 100;
    }
    //echo "custoperc===$custoperc<br />";
    
    $custoperc = $custoperc * 1000;
    
    $vetGrafico_1[$custoperc][$codigo_secao]=$descricao_secao;
}
krsort($vetGrafico_1);
//p($vetGrafico_1);



ForEach ($vetDeptoc as $codigo_secao => $Qtd) {
    $sqllw   = 'select ';
    $sqllw  .= '  sca_os.* ';
    $sqllw  .= '  from  sca_organizacao_secao  sca_os ';
    $sqllw  .= '  where sca_os.idt_organizacao  = '.null($idt_organizacao);
    $sqllw  .= '   and sca_os.codigo            = '.aspa($codigo_secao);
    $rslw    = execsql($sqllw);
    $descricao_secao = "";
    ForEach($rslw->data as $rowlw)
    {
        $descricao_secao        = $rowlw['descricao'];
    }

    if (substr($codigo_secao,0,2)=="99")
    {
        $codigo_secao    = "9999999";
        $descricao_secao = "CEDIDO A OUTROS ORGÃOS";

    }

    $Qtd     = $Qtd * 1000;
    $qtdperc = ( $Qtd/$totalgeral ) * 100;
    $vetGrafico_2[$qtdperc][$codigo_secao]=$descricao_secao;
}
krsort($vetGrafico_2);

//
//  Departamento
//
echo "<br />" ;

///////////////////////////////////////////////////// matriz de perfil
echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class='contrato_cab_tr'>  ";
$onclickw = "onclick='MostraMatizPerfil();'";
$bt_baixo = '&nbsp;&nbsp;<img '.$onclickw.' id="matriz_perfil" src="imagens/seta_baixo.png" width="21" height="21" style="cursor:pointer; border:0;"  title="Mostra Matriz de Departamento"/>&nbsp;&nbsp;&nbsp;';
echo "   <td colspan='4' class='contrato_cab_td' style='font-size:20px;  background:#a6a6a6; text-align:left;' >{$bt_baixo}MATRIZ PARA PERFIL</td> ";
echo "</tr>";

echo "<tr class='contrato_cab_tr matriz_perfil' style='display:none;'>  ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center; ' ><span style='font-size:18px;'>&nbsp;CÓDIGO<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left; ' ><span style='font-size:18px;'>&nbsp;DENOMINAÇÃO DO<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left; ' ><span style='font-size:18px;'>&nbsp;CARGO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left;' ><span style='font-size:18px;'>&nbsp;COLABORADOR</span></td> ";
echo "</tr>";
$codigo_secaow="#";
$cargow       ="###";
$vetSecaoCargoProcessoPessoas[$codigo_secao][$cargo][$sca_op_codigo]=$nom_funcionario;
ForEach ($vetSecaoCargoProcessoPessoas as $codigo_secao => $VetCargo) {
    $NomeDepto = $vetDeptoNom[$codigo_secao];
    ForEach ($VetCargo as $cargo => $vetPessoas) {
      ForEach ($vetPessoas as $chapa => $nome_pessoa) {
        echo "<tr class='contrato_cab_tr matriz_perfil' style='display:none;'>  ";
        if ($codigo_secao!=$codigo_secaow)
        {
            //$onclickw = " onclick='return ChamaDepto(".'"'.$codigo_secao.'"'.")'; ";
            $onclickw    = "";
            echo "   <td class='contrato_cab_td' style='background:#F2F2F2; color:#000000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;$codigo_secao</span></td> ";
            echo "   <td class='contrato_cab_td' {$onclickw} title='Lista Colaboradores do Departamento' style='cursor:pointer; background:#F2F2F2; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;$NomeDepto</span></td> ";
            $codigo_secaow=$codigo_secao;
            $cargow="###";
            $bgcolor="#F2F2F2";
        }
        else
        {
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
            $bgcolor="#FFFFFF";
        }
        if ($cargo!=$cargow)
        {
            $onclickw    = "";
            echo "   <td class='contrato_cab_td'   style='background:{$bgcolor}; color:#000000; text-align:left;' >&nbsp;$cargo</td> ";
            $cargow=$cargo;
        }
        else
        {
            echo "   <td class='contrato_cab_td' style='background:{$bgcolor}; color:#000000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        }

        echo "   <td class='contrato_cab_td' style='background:{$bgcolor}; color:#000000; text-align:left; padding-right:20px; ' >&nbsp;$nome_pessoa</td> ";
        echo "</tr>";
      }
    }
}
echo "</table>" ;

///////////////////////////////////////////////////// fim matriz de perfil
echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";



//echo "<tr class='contrato_cab_tr'>  ";
//echo "   <td colspan='5' class='contrato_cab_td' style='font-size:20px;  background:#600000; text-align:center;' >Histórico Funcional cadastrado em {$dt_carga} <br /> {$tipo} :: {$nom_arquivo}</td> ";
//echo "</tr>";









echo "<tr class='contrato_cab_tr'>  ";
//echo "   <td colspan='5' class='contrato_cab_td' style='font-size:20px; background:#600000; text-align:left;' >MATRIZ DE DEPARTAMENTO</td> ";


$onclickw = "onclick='MostraMatizDepto();'";
$bt_baixo = '&nbsp;&nbsp;<img '.$onclickw.' id="matriz_depto" src="imagens/seta_baixo.png" width="21" height="21" style="cursor:pointer; border:0;"  title="Mostra Matriz de Departamento"/>&nbsp;&nbsp;&nbsp;';
echo "   <td colspan='5' class='contrato_cab_td' style='font-size:20px;  background:#a6a6a6; text-align:left;' >{$bt_baixo}MATRIZ QUANTITATIVA DE DEPARTAMENTO</td> ";


echo "</tr>";



echo "<tr class='contrato_cab_tr matriz_depto' style='display:none;'>  ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center; ' ><span style='font-size:18px;'>&nbsp;CÓDIGO<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center; ' ><span style='font-size:18px;'>&nbsp;NOME<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left;' ><span style='font-size:18px;'>&nbsp;QUANTIDADE<br />COLABORADORES<br />(DEPARTAMENTO)</span></td> ";
//echo "   <td class='contrato_cab_td' style='background:#CC0000; text-align:left;' >&nbsp;Custo<br />(Departamento)</td> ";



echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center;' ><span style='font-size:18px;'>&nbsp;CARGO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center;' ><span style='font-size:18px;'>&nbsp;QUANTIDADE<br />COLABORADORES<br />(CARGO)</span></td> ";
//echo "   <td class='contrato_cab_td' style='background:#CC0000; text-align:center;' >&nbsp;Custo<br />(Cargo)</td> ";
echo "</tr>";
$codigo_secaow="#";
ForEach ($vetDepto as $codigo_secao => $VetCargo) {
    $NomeDepto = $vetDeptoNom[$codigo_secao];
    ForEach ($VetCargo as $cargo => $qtd) {
        echo "<tr class='contrato_cab_tr matriz_depto' style='display:none;'>  ";
        if ($codigo_secao!=$codigo_secaow)
        {
            $onclickw = " onclick='return ChamaDepto(".'"'.$codigo_secao.'"'.")'; ";
            $colDepto = $vetDeptoc[$codigo_secao];
            
            
            $custoDepto = $vetCustoDepto[$codigo_secao];
            
            $custoDeptow = format_decimal($custoDepto);

            
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;$codigo_secao</span></td> ";
            echo "   <td class='contrato_cab_td' {$onclickw} title='Lista Colaboradores do Departamento' style='cursor:pointer; background:#FFFFFF; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;$NomeDepto</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:right; padding-right:20px; ' ><span style='font-size:18px;'>&nbsp;$colDepto</span></td> ";
     //       echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:right; padding-right:20px; ' ><span style='font-size:18px;'>&nbsp;$custoDeptow</span></td> ";
            $codigo_secaow=$codigo_secao;
        }
        else
        {
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
       //     echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; ' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        }
        
        $onclickw = " onclick='return ChamaDeptoCargo(".'"'.$codigo_secao.'", '.'"'.$cargo.'" '.")'; ";
        //echo "   <td class='contrato_cab_td' {$onclickw} title='Lista Colaboradores do Cargo do Departamento'  style='cursor:pointer; background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;$cargo</td> ";
        
        echo "   <td class='contrato_cab_td'   style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;$cargo</td> ";
        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:right; padding-right:20px; ' >&nbsp;$qtd</td> ";
        
        $custoCargoSecao = $vetCustoDeptoCargo[$codigo_secao][$cargo];
        
        $custoCargoSecaow = format_decimal($custoCargoSecao);
        
       // echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:right; padding-right:20px; ' >&nbsp;$custoCargoSecaow</td> ";

        
        
        echo "</tr>";
    }
}


        echo "<tr class='contrato_cab_tr matriz_depto' style='display:none;' >  ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:center; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; xwidth:10%; padding-right:20px;' ><span style='font-size:18px;'>&nbsp;$totalgeral</span></td> ";
        $custogeralw=format_decimal($custogeral);
//        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; padding-right:20px;' ><span style='font-size:18px;'>&nbsp;$custogeralw</span></td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; padding-right:20px; ' >&nbsp;</td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; padding-right:20px; ' >&nbsp;</td> ";
       // echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; padding-right:20px; ' >&nbsp;</td> ";
        echo "</tr>";



echo "</table>" ;
//
//  Cargo
//

//echo "<br />" ;

echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";

echo "<tr class='contrato_cab_tr'>  ";
$onclickw = "onclick='MostraMatizCargo();'";
$bt_baixo = '&nbsp;&nbsp;<img '.$onclickw.' id="matriz_cargo" src="imagens/seta_baixo.png" width="21" height="21" style="cursor:pointer; border:0;"  title="Mostra Matriz de Cargo"/>&nbsp;&nbsp;&nbsp;';
echo "   <td colspan='5' class='contrato_cab_td' style='font-size:20px;  background:#a6a6a6; text-align:left;' >{$bt_baixo}MATRIZ QUANTITATIVA DE CARGO</td> ";
echo "</tr>";



echo "<tr class='contrato_cab_tr matriz_cargo' style='display:none;'>  ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left;' ><span style='font-size:18px;'>&nbsp;CARGO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:left;' ><span style='font-size:18px;'>&nbsp;TOTAL<br />COLABORADOR<br />(CARGO)</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;CÓDIGO<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center; xwidth:15%;' ><span style='font-size:18px;'>&nbsp;DENOMINAÇÃO<br />DEPARTAMENTO</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000FF; text-align:center;' ><span style='font-size:18px;'>&nbsp;QUANTIDADE<br />COLABORADORES<br />(DEPARTAMENTO)</span></td> ";
echo "</tr>";
$cargow="#";
ForEach ($vetCargo as $cargo => $VetSecao) {

    ForEach ($VetSecao as $codigo_secao => $qtd) {
        $NomeDepto = $vetDeptoNom[$codigo_secao];
        echo "<tr class='contrato_cab_tr matriz_cargo'  style='display:none;'>  ";
        if ($cargo!=$cargow)
        {
            $colCargo = $vetCargoc[$cargo];
            
            $onclickw = " onclick='return ChamaCargo(".'"'.$cargo.'"'.")'; ";

            echo "   <td class='contrato_cab_td' {$onclickw} title='Lista Colaboradores do Cargo' style='cursor:pointer; background:#FFFFFF; color:#000000; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;$cargo</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;  padding-right:20px;  ' ><span style='font-size:18px;'>&nbsp;$colCargo</span></td> ";
            $cargow=$cargo;
        }
        else
        {
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        }

        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;$codigo_secao</td> ";
        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;$NomeDepto</span></td> ";

        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:right; padding-right:20px; ' >&nbsp;$qtd</td> ";
        echo "</tr>";
    }
}


        echo "<tr class='contrato_cab_tr matriz_cargo' style='display:none;'>  ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:center; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
                echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:left; xwidth:10%;' ><span style='font-size:18px;'>&nbsp;</span></td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right;' >TOTAL&nbsp;</td> ";
        echo "   <td class='contrato_cab_td' style='background:#600000; color:#FFFFFF; text-align:right; padding-right:20px; ' >&nbsp;$totalgeral</td> ";
        echo "</tr>";
echo "</table>" ;


echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";

echo "<tr class='contrato_cab_tr'>  ";
$onclickw = "onclick='MostraGraficos();'";
$bt_baixo = '&nbsp;&nbsp;<img '.$onclickw.' id="matriz_grafico" src="imagens/seta_baixo.png" width="21" height="21" style="cursor:pointer; border:0;"  title="Mostra Gráficos"/>&nbsp;&nbsp;&nbsp;';
echo "   <td class='contrato_cab_td' style='font-size:20px;  background:#a6a6a6; text-align:left;' >{$bt_baixo}GRÁFICOS</td> ";
echo "</tr>";

echo "<tr class='contrato_cab_tr matriz_grafico_NONE' style='width:100%; display:none;'>  ";
echo "   <td class='contrato_cab_td'   style='border-bottom:2px solid red; width:100%;  background:#FFFFFF; text-align:left;' >";
echo "   <div id='grafico_1' style='width:100%; height:1500px; display:block;' > ";
echo "   </div> ";
echo "   </td> ";
echo "</tr>";

echo "<tr class='contrato_cab_tr matriz_grafico' style='width:100%; display:none;'>  ";
echo "   <td class='contrato_cab_td'   style='border-bottom:2px solid red; width:99%;  background:#FFFFFF; text-align:left;' >";
echo "   <div id='grafico_2' style='width:100%; height:2000px; display:block;' > ";
echo "   </div> ";
echo "   </td> ";
echo "</tr>";

echo "</table>" ;


$lista_departamentos="'dep 1','dep 2'";
$custo_departamentos="23,45";

$lista_departamentos="";
$custo_departamentos="";
$virgula="";
ForEach ($vetGrafico_1 as $Custo => $vetdepto) {
   ForEach ($vetdepto as $codigo_secao => $descricao_secao) {
       $dtpo = "";
       if ($descricao_secao!="")
       {
           $dtpo = aspa($descricao_secao);
       }
       $lista_departamentos .=$virgula.$dtpo;
       $Custow = $Custo /1000;
       $custo_departamentos .=$virgula.$Custow;
       $virgula=",";
   }
}

$lista_departamentos2="";
$custo_departamentos2="";
$virgula="";
ForEach ($vetGrafico_2 as $Qtd => $vetdepto) {
   ForEach ($vetdepto as $codigo_secao => $descricao_secao) {
       $dtpo = "";
       if ($descricao_secao!="")
       {
           $dtpo = aspa($descricao_secao);
       }
       
       $lista_departamentos2 .=$virgula.$dtpo;
       $Qtdw = $Qtd /1000;
       $custo_departamentos2 .=$virgula.$Qtdw;
       $virgula=",";
   }
}


?>



<script type="text/javascript" >
var idt_organizacao = <?php echo $idt_organizacao; ?> ;


var custogeral = <?php echo $custogeral ?> ;

var totalgeral = <?php echo $totalgeral ?> ;



function ChamaDepto(codigo_secao)
{
    var opcao = "A";
    var parww='&codigo_secao='+codigo_secao+'&idt_organizacao='+idt_organizacao;
    var href='conteudo_matriz_pessoas.php?prefixo=inc&menu=matriz_lista_pessoas&print=n&titulo_rel=Colaboradores Associadas a seção '+parww;
    var  left   = 0;
    var  top    = 0;
    var  height = $(window).height();
    var  width  = $(window).width();
    top    = 50;
    left   = 150;
    width  = width  - 200;
    height = height - 100;
    var titulo = "<div style='width:700px; display:block; text-align:center; '>Colaboradores Associadas a seção "+"</div>";
    showPopWin(href, titulo , width, height, close_ChamaDepto,true,top,left);
    return false;
}

//Esmeraldo
function close_ChamaDepto(returnVal) {
   //alert(returnVal);
    //var href = "conteudo_tipologia.php?prefixo=inc&menu=tipologia_medicao&print=s&lupa=s&titulo_rel=&ampliar=S&origem=S&idt_empreendimento="+idt_empreendimento;
    //self.location =  href;
}

function ChamaDeptoCargo(codigo_secao, cargo)
{
   alert(codigo_secao+ ' ====  ' +cargo);
   return false;
}



function ChamaCargo(cargo)
{
    var opcao = "A";
    var parww='&cargo='+cargo+'&idt_organizacao='+idt_organizacao;
    var href='conteudo_matriz_cargo.php?prefixo=inc&menu=matriz_lista_cargo&print=n&titulo_rel=Colaboradores Associadas ao Cargo '+parww;
    var  left   = 0;
    var  top    = 0;
    var  height = $(window).height();
    var  width  = $(window).width();
    top    = 50;
    left   = 150;
    width  = width  - 200;
    height = height - 100;
    var titulo = "<div style='width:700px; display:block; text-align:center; '>Colaboradores Associadas ao cargo "+"</div>";
    showPopWin(href, titulo , width, height, close_ChamaCargo,true,top,left);
}

function close_ChamaCargo(returnVal) {
   //alert(returnVal);
    //var href = "conteudo_tipologia.php?prefixo=inc&menu=tipologia_medicao&print=s&lupa=s&titulo_rel=&ampliar=S&origem=S&idt_empreendimento="+idt_empreendimento;
    //self.location =  href;
}



function MostraMatizCargo()
{
    var id   = '#matriz_cargo';
    var img  = $(id);
    var flag = 0;
    
    if (img.attr('src') == 'imagens/seta_baixo.png') {
         img.attr('title', 'Esconde Matriz de Cargo');
         img.attr('src', 'imagens/seta_cima.png');
         flag = 1;
    } else {
         img.attr('src', 'imagens/seta_cima.png');
         img.attr('title', 'Mostra Matriz de Cargo');
         img.attr('src', 'imagens/seta_baixo.png');
         flag = 0;
    }
    
    $('.matriz_cargo').each(function () {
       $(this).toggle();
       }
    )
   
}
function MostraMatizDepto()
{
    var id   = '#matriz_depto';
    var img  = $(id);
    var flag = 0;

    if (img.attr('src') == 'imagens/seta_baixo.png') {
         img.attr('title', 'Esconde Matriz de Departamento');
         img.attr('src', 'imagens/seta_cima.png');
         flag = 1;
    } else {
         img.attr('src', 'imagens/seta_cima.png');
         img.attr('title', 'Mostra Matriz de Departamento');
         img.attr('src', 'imagens/seta_baixo.png');
         flag = 0;
    }
    $('.matriz_depto').each(function () {
       $(this).toggle();
       }
    )
}

function MostraMatizPerfil()
{
    var id   = '#matriz_perfil';
    var img  = $(id);
    var flag = 0;

    if (img.attr('src') == 'imagens/seta_baixo.png') {
         img.attr('title', 'Esconde Matriz de Departamento');
         img.attr('src', 'imagens/seta_cima.png');
         flag = 1;
    } else {
         img.attr('src', 'imagens/seta_cima.png');
         img.attr('title', 'Mostra Matriz de Departamento');
         img.attr('src', 'imagens/seta_baixo.png');
         flag = 0;
    }
    $('.matriz_perfil').each(function () {
       $(this).toggle();
       }
    )
}


function MostraGraficos()
{
    var id   = '#matriz_grafico';
    var img  = $(id);
    var flag = 0;
    if (img.attr('src') == 'imagens/seta_baixo.png') {
         img.attr('title', 'Esconde Gráficos');
         img.attr('src', 'imagens/seta_cima.png');
         flag = 1;
    } else {
         img.attr('src', 'imagens/seta_cima.png');
         img.attr('title', 'Mostra Gráficos');
         img.attr('src', 'imagens/seta_baixo.png');
         flag = 0;
    }
    $('.matriz_grafico').each(function () {
       $(this).toggle();
       }
    )
}

</script>


<script type="text/javascript">


//alert(' 2222222222 ');
			var chart;
			$(document).ready(function() {
				chart = new Highcharts.Chart({
					chart: {
						renderTo: 'grafico_1',
						defaultSeriesType: 'bar'
					},
					title: {
						text: 'Custo por Departamento - % <br /> Custo total de R$ <?php echo $custogeralw ?> <br /> '
					},
					xAxis: {
                        min: 0,
						categories: [
                        <?php echo $lista_departamentos ?>
                         ],
                         style: {
                              font: 'bold 9px  Arial, Verdana,  sans-serif'
                         }


					},
					yAxis: {
						min: 0,
						title: {
							text: null
						}
					},
					credits: {
						enabled: false
					},

					legend: {
						backgroundColor: '#FFFFFF',
						enabled: false
						// reversed: true
					},
					tooltip: {
						formatter: function() {
                            var custo = (this.y/100) * custogeral;
							return ''+
								 this.series.name +': '+ am_decimal(Highcharts.numberFormat( custo  , 2)) +' R$';
						}
					},
					plotOptions: {
				//		series: {
				//			stacking: 'normal'
				//		},
						bar: {
							dataLabels: {
								enabled: true,
								color: '#373737',

								y:4,
					            style: {
                                      font: 'normal 9px  Arial, Verdana,  sans-serif'
                                },
                    			formatter: function() {
                                    if (this.y!=0)
                                    {
      							        return ''+
	        							          am_decimal(Highcharts.numberFormat(this.y, 2)) +'';
	        					    }
	        					    else
	        					    {
                                        return '';
                                    }
						        }
							}
						}
					},
				        series: [{
						   name: 'Percentual de Custo',
						   data: [<?php echo $custo_departamentos ?>],
						   color: 'rgba(0, 0, 255, 1)'

					    }]
//					    exporting: {
//            filename: 'avanco_fisico'
 //       }
				});

                // the button handler
                 // The button action
    $('#button').click(function() {
        var series = chart.get('series-1');
        alert ('The first series\' name is '+ series.name);
    });

			});


		</script>





<script type="text/javascript">
//alert(' 2222222222 ');
			var chart;
			$(document).ready(function() {
				chart = new Highcharts.Chart({
					chart: {
						renderTo: 'grafico_2',
						defaultSeriesType: 'bar'
					},
					title: {
						text: 'Percentual (%) de Colaboradores por Departamento <br /> Quantidade Total <?php echo $totalgeralw ?> <br /> '
					},
					xAxis: {
                        min: 0,
						categories: [
                        <?php echo $lista_departamentos2 ?>
                         ],
                         style: {
                              font: 'bold 9px  Arial, Verdana,  sans-serif'
                         }


					},
					yAxis: {
						min: 0,
						title: {
							text: null
						}
					},
					credits: {
						enabled: false
					},

					legend: {
						backgroundColor: '#FFFFFF',
						enabled: false
						// reversed: true
					},
					tooltip: {
						formatter: function() {

                            var qtdgeral = (this.y/100) * totalgeral;


							return ''+
								 this.series.name +': '+ am_decimal(Highcharts.numberFormat(qtdgeral, 2)) +' R$';
						}
					},
					plotOptions: {
				//		series: {
				//			stacking: 'normal'
				//		},
						bar: {
							dataLabels: {
								enabled: true,
								color: '#373737',

								y:4,
					            style: {
                                      font: 'normal 9px  Arial, Verdana,  sans-serif'
                                },
                    			formatter: function() {
                                    if (this.y!=0)
                                    {
      							        return ''+
	        							          am_decimal(Highcharts.numberFormat(this.y, 2)) +'';
	        					    }
	        					    else
	        					    {
                                        return '';
                                    }
						        }
							}
						}
					},
				        series: [{
						   name: 'Quantidade de Colaboradores',
						   data: [<?php echo $custo_departamentos2 ?>],
						   color: 'rgba(0, 0, 255, 1)'

					    }]
//					    exporting: {
//            filename: 'avanco_fisico'
 //       }
				});

                // the button handler
                 // The button action
    $('#button').click(function() {
        var series = chart.get('series-1');
        alert ('The first series\' name is '+ series.name);
    });

			});


		</script>
