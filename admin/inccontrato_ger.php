
<style type="text/css">


div#contrato {
    soverflow:auto;
    sheight: 380px;
    swidth : 680px;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    background: #FFFFFF;
    margin-top:0px;
}


div#contrato_1 {
    soverflow:auto;
    sheight: 360px;
    swidth : 670px;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    padding:0px;
    background: #FFFFFF;
}


table.contrato_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EFEFEF;
    background: #A2A2A2;
}

tr.contrato_table_tr {


}
td.contrato_titulo_td {
    font-weight : bold;
    color       : #FFFFFF;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
}
tr.contrato_cab_tr {

}
td.contrato_cab_td {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
}

td.contrato_cab_td_r {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
    text-align: right;
}

tr.contrato_linha_tr {

}
td.contrato_linha_td_t {
    font-weight   : normal;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t1 {
    font-weight   : normal;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t2 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t3 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}


td.contrato_linha_td_t_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t1_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t2_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t3_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}



td.contrato_linha_td_a {
    font-weight :normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_a_r {
    font-weight : normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_a_r a {
    font-weight : bold;
    color       :#900000;
    text-decoration:none;
}

div#contrato_c {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    height:10px;
    margin:0px;
}

div#contrato_r {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    height:10px;
    margin:0px;
    float:left;
}


div#mostra_aditivo {
    position:absolute;
    
    left:240px;
    top:150px;
    
    width :700px;
    height:200px;
    
    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#mostra_aditivo img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#mostra_aditivo_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#mostra_aditivo_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#mostra_aditivo_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}

td.cabecalho_campo {
   color: #FFFFFF;
   font-weight: bold;
   padding-bottom:10px;
   border-bottom:1px;
   background:#808080;

}
td.linha_campo {
   color: #202020;
}


div#legenda {
    swidth : 670px;
    width : 100%;
    height: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda_l {
    font-size: 12px;
    color:#000000;
    float:right;
    padding-top:10px;
    margin-left:10px;
    margin-right:5px;
}


div#legenda_i {
    color:#858585;
    sfloat:left;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:15px;
}


table.legenda_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EAEAEA;
}

tr.legenda_cab_tr {


}
td.legenda_cab_td {
    font-weight : bold;
    color       : #B9B9B9;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom: 1px solid #000000;
}

div#contrato_edoc {
    position:absolute;

    left:240px;
    top:150px;

    width :700px;
    height:200px;

    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#contrato_edoc img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#contrato_edoc_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#contrato_edoc_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#contrato_edoc_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}

div#voltar_full_m  {
    float:left;
    height:25px;
    background:transparent;
    sbackground:red;
    margin:0px;
    padding:0px;
}

div#voltar_full_m img {
    cursor: pointer;
}

.voltar  {
    float:left;
}


div#area_imprime {
    float:left;
    background: #FFFFFF;
    text-align:right;
    background:blue;

}
div#area_imprime img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_excel {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_excel img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_doc {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_doc img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}


</style>


<?php



if ($_GET['print'] != 's') {
    echo ' <div id="voltar_full_m">';

    echo ' <div class="voltar">';
    echo '         <img src="imagens/menos_full_pco.jpg" title="Voltar"   width="16" height="16"  style="padding:5px; " alt="Voltar" border="0" onclick="self.location = '."'".$url_volta."'".'" style="cursor: pointer;">';
    echo ' </div>';

    $nome_pr   = 'contrato_ger';
    $nome_ex   = 'CONTRATOS - ';
    $titulo_rl = 'Contratos';
    echo "<div id='area_imprime' >";
   // echo '<a target="_blank" href="conteudo_print.php?prefixo=inc&menu='.$nome_pr.'&print=s&titulo_rel='.$titulo_rl.$parww.'" ><img style="padding:5px; "  src="imagens/impressora.gif" width="16" height="16" title="Preparar para Impressão" alt="Preparar para Impressão"  border="0" /></a>';
    echo '<a href="#"  onclick="return chama_orcamento('."'".$nome_pr."', "."'".$titulo_rl."'".');" ><img style="padding:5px; "  src="imagens/impressora.gif" width="16" height="16" title="Preparar para Impressão" alt="Preparar para Impressão"  border="0" /></a>';
    echo "</div>";

    echo ' </div>';
    echo "<br /><br /><br />";
}




$sql     = 'select  idt, estado, descricao from empreendimento ';
$sql    .= '    order by estado, descricao ';
$Filtro  = Array();
$Filtro['rs'] = execsql($sql);

$par_auto=" onChange = 'document.frm.submit();' ";


//if ($_GET['idt0']!='')
//{
    //$Filtro['vlPadrao'] = $_SESSION[CS]['g_idt_obra'];
//}
//else
//{
    $Filtro['vlPadrao'] = $_SESSION[CS]['g_idt_obra'];
    $_GET['idt0'] = $_SESSION[CS]['g_idt_obra'];
    $_GET['pri']='S';
//}

$Filtro['LinhaUm']  = ' Listar Todas as Obras ';
$Filtro['id'] = 'idt';
$Filtro['js'] = $par_auto;
$Filtro['nome'] = 'Empreendimento';
$Filtro['valor'] = trata_id($Filtro);
$vetFiltro['empreendimento'] = $Filtro;

//$sql     = 'select  idt, razao_social from fornecedor ';
//$sql    .= '    order by razao_social ';

$sql     = 'select distinct fo.idt, fo.razao_social from fornecedor fo ';
$sql    .= ' inner join contrato co on co.idt_fornecedor = fo.idt ';
$sql    .= ' where co.idt_empreendimento = '.null($vetFiltro['empreendimento']['valor']);
$sql    .= '    order by razao_social ';


$Filtro  = Array();
$Filtro['rs'] = execsql($sql);
$Filtro['LinhaUm'] = ' Listar Todos os Fornecedores ';
$Filtro['id'] = 'idt';
$Filtro['vlPadrao'] = -1;

$Filtro['js'] = "style='width:400px;'".$par_auto;
$Filtro['nome'] = 'Fornecedor';
$Filtro['valor'] = trata_id($Filtro);
$vetFiltro['fornecedor'] = $Filtro;

$sql     = 'select  distinct oi.idt , oi.classificacao, oi.descricao from orcamento_item oi ';
$sql    .= ' inner join contrato_servico cs on cs.idt_orcamento_item = oi.idt ';
$sql    .= ' inner join contrato co on co.idt = cs.idt_contrato ';

if ($vetFiltro['empreendimento']['valor']!=-1)
{
    $sql .= ' where oi.idt_empreendimento = '.null($vetFiltro['empreendimento']['valor']);
    if ($vetFiltro['fornecedor']['valor']!=-1)
    {
        $sql .= ' and  co.idt_fornecedor = '.null($vetFiltro['fornecedor']['valor']);
    }
}
else
{
    if ($vetFiltro['fornecedor']['valor']!=-1)
    {
        $sql .= ' where  co.idt_fornecedor = '.null($vetFiltro['fornecedor']['valor']);
    }
}

$sql    .= '    order by oi.classificacao ';




$Filtro  = Array();
$Filtro['rs'] = execsql($sql);
$Filtro['LinhaUm'] = ' Listar Todos os Serviços ';
$Filtro['vlPadrao'] = -1;

$Filtro['id'] = 'idt';
$Filtro['js'] = "style='width:400px;'".$par_auto;
$Filtro['nome'] = 'Serviços';
$Filtro['valor'] = trata_id($Filtro);
$vetFiltro['servico'] = $Filtro;



echo "<div id='mostra_aditivo'>";
echo "    <div id='mostra_aditivo_cab'>";
echo "         <img onclick='desativa_mostra_aditivo();' src='imagens/fechar.gif' border='0'>";
echo "          Aditivos do Contrato";
echo "    </div>";
echo "    <div id='mostra_aditivo_det'>";
echo "    <img src='imagens/carregando_1.gif' />";
echo "    </div>";
echo "</div>";

echo "<div id='contrato_edoc'>";
echo "    <div id='contrato_edoc_cab'>";
echo "         <img onclick='desativa_contrato_edoc();' src='imagens/fechar.gif' border='0'>";
echo "          Aguarde carregando Contratos do e_doc";
echo "    </div>";
echo "    <div id='contrato_edoc_det'>";
echo "    <a><img src='imagens/carregando_1.gif' />Aguarde...</a>";
echo "    </div>";
echo "</div>";



echo '<form name="frm" target="_self" action="conteudo.php?'.substr(getParametro($strPara),1).'" method="post">';



if ($_GET['print'] != 's') {
    $Focus = '';
    codigo_filtro(false,false);
    onLoadPag($Focus);
}



echo "<div id='legenda'> ";
$sqll   = 'select ';
$sqll  .= '  foat.descricao     as foat_descricao, ';
$sqll  .= '  foat.imagem        as foat_imagem,   ';
$sqll  .= '  foat.peso          as foat_peso   ';
$sqll  .= '  from fornecedor_avaliacao foat ';
$sqll  .= '  order by peso desc ';
$rsl = execsql($sqll);
$path='admin/obj_file/fornecedor_avaliacao/';
$vet_peso_img=Array();
$vet_peso_des=Array();

ForEach($rsl->data as $rowl) {
    $foat_imagem         = $rowl['foat_imagem'];
    $foat_descricao      = $rowl['foat_descricao'];
    $classe ='legenda_cab_td';
    $classer='legenda_cab_td';
    $vet_peso_img[$rowl['foa_peso']]=$rowl['foa_imagem'];
    $vet_peso_des[$rowl['foa_peso']]=$rowl['foa_descricao'];

    echo "<div id='legenda_i'> ";
    ImagemProd(16 , 16, $path, $foat_imagem, $foat_descricao);
    echo "   ".$foat_descricao." ";
    echo "</div>";
}

echo "<div id='legenda_l'> ";
echo "Legenda:";
echo "</div>";
echo "</div>";



$patha='admin/obj_file/fornecedor_avaliacao/';


$paths='admin/obj_file/contrato_situacao/';








$sql   = 'select ';
$sql  .= '  em.descricao      as em_descricao, ';
$sql  .= '  co.idt            as co_idt, ';
$sql  .= '  co.idt_fornecedor as co_idt_fornecedor, ';
$sql  .= '  co.numero         as co_numero, ';
$sql  .= '  co.valor_contrato as co_valor_contrato, ';
$sql  .= '  co.valor_aditivo  as co_valor_aditivo, ';
$sql  .= '  co.valor_pago     as co_valor_pago, ';
$sql  .= '  cs.descricao      as cs_descricao,   ';

$sql  .= '  fo.fantasia      as fo_fantasia, ';
$sql  .= '  fo.razao_social  as fo_razao_social, ';
$sql  .= '  oi.descricao     as oi_descricao, ';
$sql  .= '  csi.imagem        as csi_imagem,   ';
$sql  .= '  csi.descricao        as csi_descricao,   ';
$sql  .= '  css.imagem       as css_imagem,   ';
$sql  .= '  cst.descricao     as cst_descricao, ';
$sql  .= '  cst.imagem       as cst_imagem,   ';
$sql  .= '  co.nota           as co_nota,   ';
$sql  .= '  foa.descricao      as foa_descricao,   ';
$sql  .= '  foa.imagem         as foa_imagem   ';

$sql  .= '  from contrato co ';
$sql  .= '  inner join contrato_status   cst on cst.idt = co.idt_status_conclusao ';
$sql  .= '  inner join empreendimento    em  on em.idt           = co.idt_empreendimento ';
$sql  .= '  inner join fornecedor        fo  on fo.idt           = co.idt_fornecedor ';
$sql  .= '  left  join contrato_servico  cs  on cs.idt_contrato  = co.idt ';
$sql  .= '  left  join orcamento_item    oi  on oi.idt           = cs.idt_orcamento_item ';
$sql  .= '  left  join contrato_status   css on css.idt          = cs.idt_status_conclusao ';
$sql  .= '  inner join contrato_situacao csi on csi.idt          = co.idt_situacao ';
$sql  .= '  inner join contrato_tipo     ct  on ct.idt           = co.idt_tipo     ';
$sql  .= '  left  join fornecedor_avaliacao  foa  on foa.idt         = co.idt_avaliacao     ';

/*
$sql .= ' where ';
$sql .= '    co.idt_empreendimento = '.null($_SESSION[CS]['g_idt_obra']);

if ($vetFiltro['fornecedor']['valor']!=-1)
{
    $sql .= ' and ';
    $sql .= '   co.idt_fornecedor = '.null($vetFiltro['fornecedor']['valor']);
}
$sql .= ' order by fo.razao_social ';

*/
if ($vetFiltro['empreendimento']['valor']!=-1)
{
    $sql .= ' where ';
    $sql .= '    co.idt_empreendimento = '.null($vetFiltro['empreendimento']['valor']);
}


if ($vetFiltro['fornecedor']['valor']!=-1)
{
    if ($vetFiltro['empreendimento']['valor']!=-1)
    {
       $sql .= ' and ';
    }
    else
    {
       $sql .= ' where ';
    }
    $sql .= '   co.idt_fornecedor = '.null($vetFiltro['fornecedor']['valor']);
}

if ($vetFiltro['servico']['valor']!=-1 and $vetFiltro['servico']['valor']!=0)
{
    if ($vetFiltro['empreendimento']['valor']!=-1 or $vetFiltro['fornecedor']['valor']!=-1)
    {
       $sql .= ' and ';
    }
    else
    {
       $sql .= ' where ';
    }
    $sql .= '   oi.idt = '.null($vetFiltro['servico']['valor']);
}

//$sql .= ' order by oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';

$sql .= ' order by ';
//p($vetFiltro['empreendimento']['valor']);

if ($vetFiltro['empreendimento']['valor']!=-1)
{
    $sql .= ' em.descricao ';
    if ($vetFiltro['fornecedor']['valor']!=-1)
    {
        //$sql .= ', fo.razao_social ';
        $sql .= ', YEAR(data_inicio), co.numero ';
        if ($vetFiltro['servico']['valor']!=-1)
        {
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
        }
        else
        {
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
        }
    }
    else
    {
       // p($vetFiltro['servico']['valor']);
        if ($vetFiltro['servico']['valor']>0)
        {
            $sql .= ', YEAR(data_inicio), co.numero ';
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
            //$sql .= ', fo.razao_social ';
           // $sql .= ', YEAR(data_inicio), co.numero ';
        }
        else
        {
            //$sql .= ', fo.razao_social ';
            $sql .= ', YEAR(data_inicio), co.numero ';
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
        }

    }
}
else
{
    if ($vetFiltro['fornecedor']['valor']!=-1)
    {
        //$sql .= ' fo.razao_social ';
        $sql .= ' YEAR(data_inicio), co.numero ';
        if ($vetFiltro['servico']['valor']!=-1)
        {
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
            //$sql .= ', fo.razao_social ';
            $sql .= ', YEAR(data_inicio), co.numero ';
        }
        else
        {
            //$sql .= ', fo.razao_social ';
            $sql .= ', YEAR(data_inicio), co.numero ';
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
        }
    }
    else
    {
        if ($vetFiltro['servico']['valor']!=-1)
        {
            $sql .= ' oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
            $sql .= ', fo.razao_social ';
          //  $sql .= ', co.numero ';
        }
        else
        {
            //$sql .= ', fo.razao_social ';
           // $sql .= ', co.numero ';
            $sql .= ' em.descricao, YEAR(data_inicio), co.numero ';
            $sql .= ', oi.descricao, cs.valor_unitario, cs.descricao,  fo.fantasia ';
        }
    }
    $sql .= ', em.descricao ';
}
//p($sql);
//exit();
$rs = execsql($sql);
$path='admin/obj_file/contrato_status/';
if ($rs->rows == 0)
{

}
echo " <div id='contrato'> ";

//echo "<div id='contrato_c'> ";
//echo "</div>";

/*
echo "<div id='legenda'> ";
//echo "<table class='legenda_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
//echo "<tr class='legenda_cab_tr'>  ";
$sqll   = 'select ';
$sqll  .= '  cst.descricao     as cst_descricao, ';
$sqll  .= '  cst.imagem        as cst_imagem   ';
$sqll  .= '  from contrato_status cst ';
$sqll  .= '  order by codigo desc ';
$rsl = execsql($sqll);
ForEach($rsl->data as $rowl) {
    $cst_imagem         = $rowl['cst_imagem'];
    $cst_descricao      = $rowl['cst_descricao'];
    $classe ='legenda_cab_td';
    $classer='legenda_cab_td';

    
    echo "<div id='legenda_i'> ";
//    echo "   <td class='{$classe}' >";
         ImagemProd(16 , 16, $path, $cst_imagem, $cst_descricao);
//    echo "</td> ";
//    echo "   <td class='{$classer}' >".$cst_descricao."</td> ";
      echo "   ".$cst_descricao." ";
      echo "</div>";
}

echo "<div id='legenda_l'> ";
echo "Legenda:";
echo "</div>";


//echo "</tr>";
//echo "</table>";
echo "</div>";

*/



echo " <div id='contrato_1'> ";
echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class='contrato_cab_tr'>  ";
echo "   <td class='contrato_cab_td' >&nbsp;"."OBRA"."</td> ";
echo "   <td class='contrato_cab_td' width='10'>&nbsp;"."NÚMERO<br>CONTRATO"."</td> ";
echo "   <td class='contrato_cab_td' >&nbsp;"."EMPRESA"."</td> ";
echo "   <td class='contrato_cab_td' >&nbsp;"."SERVIÇO"."</td> ";
echo "   <td class='contrato_cab_td_r' >&nbsp;"."VALOR CONTRATO<br>(R$)"."</td> ";
echo "   <td class='contrato_cab_td_r' >&nbsp;"."VALOR ADITIVO<br>(R$)"."</td> ";
//echo "   <td class='contrato_cab_td_r' >&nbsp;"."VALOR PAGO<br>(R$)"."</td> ";
//echo "   <td class='contrato_cab_td_r' >&nbsp;"."SALDO<br>(R$)"."</td> ";
//echo "   <td class='contrato_cab_td_r' >STS</td> ";
echo "   <td class='contrato_cab_td_r' >AVALIAÇÃO</td> ";
echo "</tr>";
$idt_contrato=0;

//p($sql);

$separa='';
$oi_descricao_ac='';
ForEach($rs->data as $row) {
   if ($em_descricao.$fo_razao_social.$idt_contrato!=$row['em_descricao'].$row['fo_razao_social'].$row['co_idt'] and $idt_contrato!=0)
   {
       echo "<tr  class='contrato_linha_tr' >  ";
       $classe='contrato_linha_td_a';
       $classer='contrato_linha_td_a_r';
       echo "   <td class='{$classe}' >".$em_descricao."</td> ";
       
       
       $href='<a href="#" onclick="mostra_contrato('."'".$idt_contrato."'".');" >'.$co_numero.'</a>';
       $co_numero_e=$href;
       echo "   <td class='{$classer}' >".$co_numero_e."</td> ";
       echo "   <td class='{$classe}' >".$fo_razao_social."</td> ";
       echo "   <td class='{$classe}' >".$oi_descricao_ac."</td> ";

       $saldo = ($co_valor_contrato_v + $co_valor_aditivo_v) - $co_valor_pago_v;
       
       
       $saldo_e = format_decimal($saldo);

       echo "   <td class='{$classer}' >".$co_valor_contrato."</td> ";
       
       if ($co_valor_aditivo_v>0)
       {
           $href='<a href="#" onclick="mostra_aditivo('."'".$idt_contrato."'".');" >'.$co_valor_aditivo.'</a>';
           $co_valor_aditivo_e=$href;
       }
       else
       {
           $co_valor_aditivo_e=$co_valor_aditivo;
       }
       echo "   <td class='{$classer}' >".$co_valor_aditivo_e."</td> ";
  //     echo "   <td class='{$classer}' >".$co_valor_pago."</td> ";
  //     echo "   <td class='{$classer}' >".$saldo_e."</td> ";
       
//       echo "   <td class='{$classe}' >";
//         echo "&nbsp;&nbsp;";
//         ImagemProd(21 , 21, $path, $cst_imagem, $cst_descricao);
//       echo "</td> ";



//       echo "   <td class='{$classe}' >";
//         echo "&nbsp;&nbsp;";
//         ImagemProd(21 , 21, $paths, $csi_imagem, '', False, $csi_descricao);
//       echo "</td> ";

       echo "   <td class='{$classe}' style='text-align:center;'>";
//         echo '   <a href="#" onclick="mostra_avaliacao('."'".$idt_fornecedor."'".');" >';
  //////       echo '   <a href="#" onclick="return mostra_criterios('."'".$idt_fornecedor."',"."'".$idt_contrato."');".'" >';

         ImagemProd_b64(21 , 21, $patha, $foa_imagem, '', False, $foa_descricao);
  ////       echo '   </a> ';
       echo "</td> ";


       
       
       echo "</tr>";
       $separa='';
       $oi_descricao_ac='';
   }
   $em_descricao       = $row['em_descricao'];
   $idt_contrato       = $row['co_idt'];
   $idt_fornecedor     = $row['co_idt_fornecedor'];
   $co_numero          = $row['co_numero'];
   $fo_razao_social    = $row['fo_razao_social'];
   $fo_fantasia        = $row['fo_fantasia'];
   $oi_descricao       = $row['oi_descricao'];
   $cs_descricao       = $row['cs_descricao'];
   $co_valor_contrato  = format_decimal($row['co_valor_contrato']);
   $co_valor_contrato_v= $row['co_valor_contrato'];
   $co_valor_aditivo   = format_decimal($row['co_valor_aditivo']);
   $co_valor_aditivo_v = $row['co_valor_aditivo'];
   $co_valor_pago      = format_decimal($row['co_valor_pago']);
   $co_valor_pago_v    = $row['co_valor_pago'];
   $oi_descricao       = $oi_descricao.' - '.$cs_descricao;
   $oi_descricao_ac    = $oi_descricao_ac.$separa.$oi_descricao;
   
   $cst_imagem         = $row['cst_imagem'];
   $cst_descricao      = $row['cst_descricao'];


   $csi_imagem         = $row['csi_imagem'];
   $csi_descricao      = $row['csi_descricao'];

   
   $co_nota            = $row['co_nota'];
   $foa_descricao       = $row['foa_descricao'];
   $foa_imagem          = $row['foa_imagem'];


   
   
   $separa='<br>';

}

if ($idt_contrato!=0)
{
       echo "<tr  class='contrato_linha_tr' >  ";
       $classe='contrato_linha_td_a';
       $classer='contrato_linha_td_a_r';
       echo "   <td class='{$classe}' >".$em_descricao."</td> ";
       
       
       $href='<a href="#" onclick="mostra_contrato('."'".$idt_contrato."'".');" >'.$co_numero.'</a>';
       $co_numero_e=$href;
       echo "   <td class='{$classer}' >".$co_numero_e."</td> ";

       
//       echo "   <td class='{$classe}' >".$co_numero."</td> ";
       echo "   <td class='{$classe}' >".$fo_razao_social."</td> ";
       echo "   <td class='{$classe}' >".$oi_descricao_ac."</td> ";

       $saldo = ($co_valor_contrato_v + $co_valor_aditivo_v) - $co_valor_pago_v;


       $saldo_e = format_decimal($saldo);

       echo "   <td class='{$classer}' >".$co_valor_contrato."</td> ";

       if ($co_valor_aditivo_v>0)
       {
           $href='<a href="#" onclick="mostra_aditivo('."'".$idt_contrato."'".');" >'.$co_valor_aditivo.'</a>';
           $co_valor_aditivo_e=$href;
       }
       else
       {
           $co_valor_aditivo_e=$co_valor_aditivo;
       }
       echo "   <td class='{$classer}' >".$co_valor_aditivo_e."</td> ";
    //   echo "   <td class='{$classer}' >".$co_valor_pago."</td> ";
    //   echo "   <td class='{$classer}' >".$saldo_e."</td> ";
       
  //     echo "   <td class='{$classe}' >";
 //        echo "&nbsp;&nbsp;";
 //        ImagemProd(21 , 21, $path, $cst_imagem, $cst_descricao);
 //      echo "</td> ";
 
 
 //      echo "   <td class='{$classe}' >";
 //        echo "&nbsp;&nbsp;";
 //        ImagemProd(21 , 21, $paths, $csi_imagem, '', False, $csi_descricao);
 //      echo "</td> ";

       echo "   <td class='{$classe}' style='text-align:center;'>";
//       echo '   <a href="#" onclick="mostra_avaliacao('."'".$idt_fornecedor."'".');" >';
       //  echo '   <a href="#" onclick="return mostra_criterios('."'".$idt_fornecedor."',"."'".$idt_contrato."');".'" >';

         ImagemProd_b64(21 , 21, $patha, $foa_imagem, '', False, $foa_descricao);
       //  echo '   </a> ';
       echo "</td> ";

       
       echo "</tr>";

}

echo "</table>";

echo " </div> ";

//echo "<div id='contrato_r'> ";
//echo "</div>";

echo " </div> ";



if ($_GET['print'] != 's') {

$url_volta = 'conteudo'.$cont_arq.'.php';
echo ' <div id="voltar_full_m">';
echo ' <div class="voltar">';
echo '         <img src="imagens/menos_full_PCO.jpg" title="Voltar"  alt="Voltar" border="0" onclick="self.location = '."'".$url_volta."'".'" style="cursor: pointer;">';
echo ' </div>';
echo ' </div>';


}
else
{
    echo "<div style='height:25px; width:100%; background:#FF0000; display:block; '>";
    echo '&nbsp;&nbsp;<br />';
    echo '&nbsp;&nbsp;';
    echo "</div>";

}



echo '</form>';

?>



<script type="text/javascript" >
     function desativa_mostra_aditivo() {
        document.getElementById('mostra_aditivo').style.display='none';
     }
     function  mostra_aditivo(idt) {
         var msg = '';
         objd=document.getElementById('mostra_aditivo_det')
         objd.innerHTML=objd.innerHTML+msg;
         obj=document.getElementById('mostra_aditivo')
         obj.style.display='block';
         $.post('ajax.php?tipo=aditivo', {
            idt_contrato: idt
            } , function(str) {

                
                if (str == '') {

                   // objd.innerHTML=str;
                   // alert('Obra Posicionada em ');


                } else {
                   // alert(url_decode(str).replace(/<br>/gi, "\n"));
                    
                    jQuery('#mostra_aditivo_det').html(str);
                    
                    
                }
                
                
                
         });
         return false;

     }
     function desativa_contrato_edoc() {
        document.getElementById('contrato_edoc').style.display='none';
     }

     function  mostra_contrato(idt) {
         var msg = '';
         objd=document.getElementById('contrato_edoc_det')
         objd.innerHTML=objd.innerHTML+msg;
         obj=document.getElementById('contrato_edoc')
         obj.style.display='block';
         $.post('ajax.php?tipo=chama_edoc_contrato', {
            idt_contrato: idt
            } , function(str) {


                if (str == '') {

                   // objd.innerHTML=str;
                   // alert('Obra Posicionada em ');


                } else {
                   // alert(url_decode(str).replace(/<br>/gi, "\n"));

                    jQuery('#contrato_edoc_det').html(str);
                    desativa_contrato_edoc();

                }



         });
         return false;
     }

     
</script>
