
<style type="text/css">


div#contrato {
    soverflow:auto;
    sheight: 380px;
    swidth : 680px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    background: #FFFFFF;
    margin-top:0px;
}


div#contrato_1 {
    soverflow:auto;
    sheight: 360px;
    width : 670px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    padding:0px;
    background: #FFFFFF;
}


table.contrato_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EFEFEF;
    background: #A2A2A2;
}

tr.contrato_table_tr {


}
td.contrato_titulo_td {
    font-weight : bold;
    color       : #FFFFFF;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
}
tr.contrato_cab_tr {

}
td.contrato_cab_td {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #666666;
}

td.contrato_cab_td_r {
    font-weight :bold;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
    text-align: right;
}

tr.contrato_linha_tr {

}
td.contrato_linha_td_t {
    font-weight   : normal;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t1 {
    font-weight   : normal;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t2 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t3 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}


td.contrato_linha_td_t_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t1_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t2_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t3_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}



td.contrato_linha_td_a {
    font-weight :normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_a_r {
    font-weight : normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_a_r a {
    font-weight : bold;
    color       :#900000;
    text-decoration:none;
}

div#contrato_c {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    height:10px;
    margin:0px;
}

div#contrato_r {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    sheight:10px;
    margin:0px;
    float:left;
    padding-bottom:20px;
}


.quantidade_contrato {
    background:#E9E9E9;
    swidth : 100%;
    font-family :  Arial, Calibri, Helvetica, sans-serif;
    font-style: normal;
    font-size: 14px;
    font-weight: bold;
    color:#666666;

}


div#mostra_aditivo {
    position:absolute;
    
    left:240px;
    top:150px;
    
    width :700px;
    height:200px;
    
    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#mostra_aditivo img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#mostra_aditivo_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#mostra_aditivo_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#mostra_aditivo_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}

td.cabecalho_campo {
   color: #FFFFFF;
   font-weight: bold;
   padding-bottom:10px;
   border-bottom:1px;
   background:#808080;

}
td.linha_campo {
   color: #202020;
}


div#posicao_periodo {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Arial, Calibri,  Helvetica,  sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda {
    width : 670px;
    width : 100%;
    height: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda_l {
    font-size: 11px;
    color:#000000;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}


div#legenda_i {
    font-size: 11px;
    color:#858585;
    sfloat:left;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}
div#legenda_i img {
    color:#858585;
    font-weight: bold;
}
div#legenda_i span {
    color:#858585;
    font-weight: bold;
}


table.legenda_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EAEAEA;
}

tr.legenda_cab_tr {


}
td.legenda_cab_td {
    font-weight : bold;
    color       : #B9B9B9;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom: 1px solid #000000;
}


div#legenda_maior {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}




div#contrato_edoc {
    position:absolute;

    left:240px;
    top:150px;

    width :700px;
    height:200px;

    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#contrato_edoc img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#contrato_edoc_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#contrato_edoc_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#contrato_edoc_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}


div#voltar_full_m  {
    float:left;
    height:25px;
    background:transparent;
    sbackground:red;
    margin:0px;
    padding:0px;
}

div#voltar_full_m img {
    cursor: pointer;
}

.voltar  {
    float:left;
}


div#area_imprime {
    float:left;
    background: #FFFFFF;
    text-align:right;
    background:blue;

}
div#area_imprime img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_excel {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_excel img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_doc {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_doc img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}


</style>


<?php
$cargo            = $_GET['cargo'];

$idt_organizacao  = $_GET['idt_organizacao'];

$descricao_cargo   = "";

//echo " $idt_organizacao <br /> ";
//echo " $cargo <br /> ";

$sqll   = 'select ';
$sqll  .= '  sca_ca.* ';
$sqll  .= '  from  sca_organizacao_cargo sca_ca ';
$sqll  .= '  inner join sca_organizacao_secao sca_os on sca_os.idt = sca_ca.idt_secao ';
$sqll  .= '  where sca_os.idt_organizacao = '.null($idt_organizacao);
//$sqll  .= '    and sca_ca.codigo          = '.aspa($cargo);
$sqll  .= '    and sca_ca.descricao         = '.aspa($cargo);
$rsl    = execsql($sqll);
ForEach($rsl->data as $rowl)
{
    $codigo_cargo      = $rowl['codigo'];
    $descricao_cargo   = $rowl['descricao'];
}

$sqll   = 'select ';
$sqll  .= '  sca_op.*,  ';
$sqll  .= '  sca_op.codigo    as sca_op_codigo, ';
$sqll  .= '  sca_os.codigo    as sca_os_codigo, ';
$sqll  .= '  sca_os.descricao as sca_os_descricao, ';
$sqll  .= '  sca_ca.descricao as sca_ca_descricao ';
$sqll  .= '  from  sca_organizacao_secao sca_os ';
$sqll  .= '  inner join sca_organizacao_pessoa sca_op on sca_op.idt_secao = sca_os.idt ';
$sqll  .= '  inner join sca_organizacao_cargo  sca_ca on sca_ca.idt       = sca_op.idt_cargo ';
$sqll  .= '  where sca_os.idt_organizacao = '.null($idt_organizacao);
$sqll  .= '    and sca_ca.codigo          = '.aspa($codigo_cargo);
$sqll  .= '  order by sca_os.descricao, sca_op.nome ';
$rsl    = execsql($sqll);
$vetDepto     = Array();
$vetCargo     = Array();
$vetDeptoNom  = Array();
$vetNomFunc   = Array();
$vetDeptoc    = Array();
$vetCargoc    = Array();

$vetCusto = Array();
$totalgeral=0;
$custogeral=0;

//p($sqll);

ForEach($rsl->data as $rowl)
{

    $codigo_secao        = $rowl['sca_os_codigo'];
    $setor_unidade       = $rowl['sca_os_descricao'];
    $nom_funcionario     = $rowl['nome'];
    $codigo              = $rowl['sca_op_codigo'];
    //$codigo              = $rowl['idt'];
    $cargo               = $rowl['sca_ca_descricao'];
    $salario_base        = $rowl['salario_base'];
    $salario_base        = 1;


    
    $sqllw   = 'select ';
    $sqllw  .= '  sca_os.* ';
    $sqllw  .= '  from  sca_organizacao_secao sca_os ';
    $sqllw  .= '  where sca_os.idt_organizacao = '.null($idt_organizacao);
    $sqllw  .= '    and sca_os.codigo         = '.aspa($codigo_secao);
    $rslw    = execsql($sqllw);
    $descricao_secao = "";
    ForEach($rslw->data as $rowlw)
    {
        $descricao_secao        = $rowlw['descricao'];
    }
    $vetNomFunc[$codigo]    = $nom_funcionario;
    $vetFuncDepto[$codigo]  = $descricao_secao;
    $totalgeral             = $totalgeral+1;
    
    $vetCusto[$codigo]      = $salario_base;
    $custogeral             = $custogeral+$salario_base;
    
}
$rows = $rsl->rows;
//echo " rows = $rows   totalgeral == $totalgeral  <br />";


echo "<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class='contrato_cab_tr'>  ";
echo "   <td colspan='4' class='contrato_cab_td' style='font-size:20px; background:#600000; text-align:center;' >CARGO: {$descricao_cargo}</td> ";
echo "</tr>";
echo "<tr class='contrato_cab_tr'>  ";
echo "   <td class='contrato_cab_td' style='xwidth:100px; background:#0000ff; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Departamento</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000ff; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Nome</span></td> ";
echo "   <td class='contrato_cab_td' style='background:#0000ff; text-align:center; ' ><span style='font-size:18px;'>&nbsp;CHAPA</span></td> ";
//echo "   <td class='contrato_cab_td' style='background:#CC0000; text-align:center; ' ><span style='font-size:18px;'>&nbsp;Custo (R$)</span></td> ";
echo "</tr>";
$codigo_secaow="#";
ForEach ($vetNomFunc as $cpf => $nome)
{
        echo "<tr class='contrato_cab_tr'>  ";
        $departamento =  $vetFuncDepto[$cpf];
        if ($departamento != $departamentow)
        {
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; padding-right:20px; ' >&nbsp;$departamento</td> ";
            $departamentow = $departamento;
        }
        else
        {
            echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; padding-right:20px; ' >&nbsp;</td> ";
        }
        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left; padding-right:20px; ' >&nbsp;$nome</td> ";
        echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:center;' >&nbsp;$cpf</td> ";
        
        $custo  = $vetCusto[$cpf];
        $custow = format_decimal($custo);
        
  //      echo "   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:center;' >&nbsp;$custow</td> ";

        
        echo "</tr>";
}
echo "<tr class='contrato_cab_tr'>  ";
$totalgeralw = format_decimal($totalgeral,0);
echo "   <td colspan='3' class='contrato_cab_td' style='font-size:20px; background:#600000; text-align:center;' >TOTAL DE COLABORADORES {$totalgeralw}</td> ";
$custogeralw = format_decimal($custogeral);
//echo "   <td  class='contrato_cab_td' style='font-size:20px; background:#600000; text-align:center;' >{$custogeralw}</td> ";

echo "</tr>";
echo "</table>" ;

?>



<script type="text/javascript" >

var idt_organizacao = <?php echo $idt_organizacao; ?> ;


function ChamaDepto(codigo_secao)
{
    alert(codigo_secao);
    //alert(' gggg '+em_idt);
    var opcao = "A";
    var parww='&codigo_secao='+idt_organizacao+'&codigo_secao='+idt_organizacao;
    var href='conteudo_matriz_pessoas.php?prefixo=inc&menu=matriz_lista_pessoas&print=n&titulo_rel=Pessoas Associadas a seção '+codigo_secao;
    var  left   = 0;
    var  top    = 0;
    var  height = $(window).height();
    var  width  = $(window).width();
    top    = 100;
    left   = 150;
    width  = width  - 200;
    height = height - 350;
    var titulo = "<div style='width:700px; display:block; text-align:center; '>Pessoas Associadas a seção "+codigo_secao+"</div>";
    showPopWin(href, titulo , width, height, close_ChamaDepto,true,top,left);
    //***

    return false;
}

//Esmeraldo
function close_ChamaDepto(returnVal) {
   //alert(returnVal);
    //var href = "conteudo_tipologia.php?prefixo=inc&menu=tipologia_medicao&print=s&lupa=s&titulo_rel=&ampliar=S&origem=S&idt_empreendimento="+idt_empreendimento;
    //self.location =  href;

}
function ChamaDeptoCargo(codigo_secao, cargo)
{
   alert(codigo_secao+ ' ====  ' +cargo);

   return false;
}
</script>
