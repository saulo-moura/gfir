
<style type="text/css">


    .cb_texto_tit {
        background:#2A5696;
        color:#FFFFFF;
        font-size:20px;
        text-align:center;
        padding-left:10px;
		border-bottom:1px solid #FFFFFF;
		border-top:1px solid #FFFFFF;

    }
    .cb_texto_cab {
        background:#2F66B8;
        color:#FFFFFF;
        font-size:18px;
    }

    .cb_texto_cab1 {
        padding-left:10px;
    }
    .cb_texto_int_cab {
        background:#2F66B8;
        color:#FFFFFF;
        font-size:14px;
        text-align:center;
        padding-right:20px;
		border-right:1px solid #C4C9CD;

    }
	
	td.class_t {
	
	    background:#2F66B8;
        color:#FFFFFF;
        font-size:11px;
        xtext-align:center;
        padding-top:10px;
		padding-bottom:10px;
		color:#FFFFFF;
		border-right:1px solid #C4C9CD;
		border-top:1px solid #FFFFFF;
		border-bottom:2px solid #C4C9CD;

	
	}
	td.ur {
	
	    font-weight: bold;
		color:#FFFFFF;

	
	}
	.cb_texto_int_subcab {
        background:#2F66B8;
        color:#FFFFFF;
        font-size:14px;
        text-align:center;
        
		border-right:1px solid #C4C9CD;

    }

    .cb_texto_linha_par {
        background:#FFFFFF;
        font-size:11px;
		padding-top:5px;
		padding-bottom:5px;
		border-bottom:1px solid #C0C0C0;
		border-top:1px solid #FFFFFF;
		
		border-right:1px solid #C4C9CD;
    }
    .cb_texto_linha_imp {
        background:#ABBBBF;
        font-size:11px;
		padding-top:5px;
		padding-bottom:5px;
		border-bottom:1px solid #C0C0C0;
		border-top:1px solid #FFFFFF;
		
		border-right:1px solid #C4C9CD;
    }

    .cb_texto {
        color:#000000; text-align:left;
        padding-left:10px;

    }
    .cb_inteiro {
        color:#000000;
        text-align:right;
        padding-right:10px;
    }

    .cb_perc {
        color:#000000;
        text-align:right;
        padding-right:10px;
    }

    .total_g {
        background:#0080FF;
        color:#FFFFFF;
		border-top:1px solid #FFFFFF;
    }
    .semclassificar {
        background:#FF0000;
        color:#FFFFFF;
    }

    td.cb_barra_ferramenta {
	    cursor:pointer;
		background:#ECF0F1;
        color:#2C3E50;
		width:10%;
		padding:10px;
		border-right:1px solid #000000;
		border-bottom:1px solid #000000;
		border-top:1px solid #000000;
		
	}
    .parametros_visualizacao {
	    width:100%;
		background:#ECF0F1;
		display:none;
		border:1px solid #000000;
	
	}
	.parametros_l1 {
	    width:100%;
		background:#ECF0F1;
		cursor:pointer;
		xmargin-top:10px;
		padding:10px;
	}





    .cb_texto_cab {
        background:#2F66B8;
        color:#FFFFFF;
        font-size:18px;
		text-align:center;
    }
	
	
    .cb_texto {
        background:#FF0000;
        color:#FFFFFF;
        font-size:11px;
		text-align:left;
        padding-left:10px;
		border-bottom:1px solid #ECF0F1;
		border-right:1px solid #C0C0C0;
    }

    .cb_texto_s {
        background:#ECF0F1;
        color:#000000;
        font-size:12px;
		text-align:left;
        padding-left:10px;
		
		padding-top:5px;
		padding-bottom:5px;
		border-bottom:1px solid #C0C0C0;
		border-right:1px solid #C0C0C0;
    }
	
	.cb_inteiro {
        text-align:right;
        padding-right:10px;
    }









    .cb_texto {
        background:#FF0000;
        color:#FFFFFF;
        font-size:12px;
		text-align:left;
        padding:5px;
		border-bottom:1px solid #C0C0C0;
		border-right:1px solid #C0C0C0;
    }
    .cb_texto_cab {
        background:#2F66B8;
        color:#FFFFFF;
        font-size:12px;
		text-align:left;
        padding:10px;
		border-bottom:1px solid #FFFFFF;
		border-right :1px solid #FFFFFF;
    }


    .cb_texto_i {
        background:#14ADCC;
        color:#FFFFFF;
        font-size:18px;
		text-align:left;
        padding:5px;
		
		border-bottom:1px solid #FFFFFF;
		border-right:1px solid #FFFFFF;
    }
	.cb_textoin_i {
        background:#14ADCC;
        color:#FFFFFF;
        font-size:18px;
		text-align:right;
        padding:5px;
		padding-right:15px;
		
		border-bottom:1px solid #FFFFFF;
		border-right:1px solid #FFFFFF;
    }
	.cb_texto_co {
        background:#ECF0F1;
        color:#000000;
        font-size:12px;
		text-align:left;
        padding:10px;
		border-bottom:1px solid #C0C0C0;
		border-right :1px solid #C0C0C0;
    }
	.cb_texto_in {
        background:#FFFFFF;
        color:#000000;
        font-size:12px;
		text-align:left;
        padding:5px;
		border-bottom:1px solid #C0C0C0;
		border-right :1px solid #C0C0C0;
    }
	
	.cb_texto_tt {
        background:#0000FF;
        color:#FFFFFF;
        font-size:18px;
		text-align:right;
        padding:15px;
		
		border-bottom:1px solid #FFFFFF;
		border-right:1px solid #FFFFFF;
    }
	
	
	
   .cb_texto_si {
        background:#ECF0F1;
        color:#000000;
        font-size:12px;
		text-align:left;
        padding:5px;
		border-bottom:1px solid #C0C0C0;
		border-right:1px solid #C0C0C0;
    }

    .cb_texto_siv {
        background:#FF0000;
        color:#FFFFFF;
        font-size:12px;
		text-align:left;
        
		padding:5px;
		border-bottom:1px solid #C0C0C0;
		border-right:1px solid #C0C0C0;
    }



    .eleinst {
	    display:none;
	}

</style>


<?php

function CriarDimensoesArea(&$vetDimensao) {
    $kokw = 0;
	$vetEdital     = Array();
	$vetPrograma   = Array();
    $vetArea       = Array();
	$vetArea_gc    = Array();
    
    //Programas
    $sqll = 'select ';
    $sqll .= '  gec_p.* ';
    $sqll .= '  from  gec_programa gec_p ';
    $sqll .= '  order by codigo ';
    $rsl = execsql($sqll);
    ForEach ($rsl->data as $rowl) {
        $idt       = $rowl['idt'];
        $codigo    = $rowl['codigo'];
        $descricao = $rowl['descricao'];
        $ativo     = $rowl['ativo'];
        $vetPrograma[$idt] = $rowl;
    }
    // Editais
    $sql  = "select idt_editalsgc, gec_ed.idt as gec_ed_idt ,gec_epe.idt as gec_epe_idt, gec_epe.idt_etapa as gec_epe_idt_etapa ";    $sql .= "  from gec_edital gec_ed ";
    $sql .= "  inner join gec_edital_processo gec_ep on gec_ep.idt_edital = gec_ed.idt ";
    //$sql .= "  inner join gec_edital_etapas   gec_epe on gec_epe.idt_processo = gec_ep.idt and gec_epe.idt_etapa = 1 ";
    $sql .= "  inner join gec_edital_etapas   gec_epe on gec_epe.idt_processo = gec_ep.idt  ";
    $rs = execsql($sql);
    ForEach ($rs->data as $row)
    {
       $gec_epe_idt_etapa = $row['gec_epe_idt_etapa'];
       if  ($gec_epe_idt_etapa==1)
       {   // inscrição
           $idt_editalsgc  = $row['idt_editalsgc'];
           $gec_epe_idt    = $row['gec_epe_idt'];
           $gec_ed_idt     = $row['gec_ed_idt'];
           $vetEdital[$idt_editalsgc]=$gec_ed_idt;
       }
       if  ($gec_epe_idt_etapa==2)
       {   // habilitação
           $gec_epe_idt    = $row['gec_epe_idt'];
           $vetEtapaEdital2[$idt_editalsgc]=$gec_epe_idt;
       }
       if  ($gec_epe_idt_etapa==3)
       {   // Credenciamento
           $gec_epe_idt    = $row['gec_epe_idt'];
           $vetEtapaEdital3[$idt_editalsgc]=$gec_epe_idt;
       }

    }
	$vetArea=Array();
    $sqll = 'select ';
    $sqll .= '  gec_ac.* ';
    $sqll .= '  from  gec_area_conhecimento gec_ac ';
    $sqll .= '  order by codigo ';
    $rsl = execsql($sqll);
    ForEach ($rsl->data as $rowl) {
        $idt       = $rowl['idt'];
        $codigo    = $rowl['codigo'];
        $descricao = $rowl['descricao'];
        $ativo     = $rowl['ativo'];
        $vetArea[$idt] = $rowl;
    }
    $sqll = 'select ';
    $sqll .= '  gec_ac.* ';
    $sqll .= '  from  gec_area_conhecimento gec_ac ';
	$sqll .= '  where idt_programa = 1 ';
    $sqll .= '  order by codigo ';
    $rsl = execsql($sqll);
	$vetArea_gc=Array();
    ForEach ($rsl->data as $rowl) {
        $idt       = $rowl['idt'];
        $codigo    = $rowl['codigo'];
        $descricao = $rowl['descricao'];
        $ativo     = $rowl['ativo'];
        $vetArea_gc[$idt] = $rowl;
    }
	
	
	$sqll  = 'select ';
    $sqll .= '  grc_p.*, '; 
	
	$sqll .= '  grc_pt.idt as grc_pt_idt,  ';
	$sqll .= '  grc_i.codigo as grc_i_codigo,  ';
	$sqll .= '  grc_i.descricao as grc_i_descricao,  ';
	
	$sqll .= '  grc_ps.codigo as grc_ps_codigo,  ';
	$sqll .= '  grc_ps.descricao as grc_ps_descricao,  ';
	
	
	$sqll .= '  grc_pt.descricao as grc_pt_descricao,  ';
    $sqll .= '  grc_pac.idt_area as idt_area,  ';
	$sqll .= '  gec_ac.descricao_estruturada as gec_ac_descricao_estruturada  ';
    $sqll .= '  from  db_pir_grc.grc_produto grc_p ';
	$sqll .= '  left join db_pir_grc.grc_produto_situacao grc_ps on grc_ps.idt = grc_p.idt_produto_situacao  ';
	$sqll .= '  left join db_pir_grc.grc_atendimento_instrumento grc_i on grc_i.idt = grc_p.idt_instrumento  ';
    $sqll .= '  left join db_pir_grc.grc_produto_area_conhecimento grc_pac on grc_pac.idt_produto = grc_p.idt  ';
	$sqll .= '  left join db_pir_gec.gec_area_conhecimento gec_ac on gec_ac.idt = grc_pac.idt_area  ';
	$sqll .= '  left join db_pir_grc.grc_produto_tipo grc_pt on grc_pt.idt = grc_p.idt_produto_tipo  ';
	$sqll .= '  where  ';
	$sqll .= '     (grc_p.idt_produto_situacao = 2 or grc_p.idt_produto_situacao = 5)  ';
	$sqll .= "    and repasse <> 'S' ";
    $sqll .= '  order by grc_i.codigo, grc_p.idt_produto_tipo, grc_ps.codigo, grc_p.descricao ';
    $rsl = execsql($sqll);
	$vetProduto=Array();
	$vetProdutoArea=Array();
	$vetProdutoQtd=Array();
	$vetProdutoInstrumento=Array();
	$vetProdutoSituacao=Array();
	$vetProdutoQtdSituacao=Array();
    ForEach ($rsl->data as $rowl) {
        $idt                = $rowl['idt'];
        $descricao          = $rowl['descricao'];
		$idt_area           = $rowl['idt_area'];
		$idt_instrumento    = $rowl['idt_instrumento'];
		$idt_produto_situacao = $rowl['idt_produto_situacao'];
        //$vetProduto[$idt_area]           = $rowl;
		$vetProduto[$idt]                = $rowl;
		$vetProdutoArea[$idt][$idt_area] = $rowl;
		
		$vetProdutoInstrumento[$idt] = $idt_instrumento;
		$vetProdutoSituacao[$idt] = $idt_produto_situacao;
    }
	ForEach ($vetProdutoInstrumento as $idt_produto => $idt_instrumento)
	{
	   $vetProdutoQtd[$idt_instrumento] = $vetProdutoQtd[$idt_instrumento]+1;
	   $idt_produto_situacao = $vetProdutoSituacao[$idt_produto];
	   $vetProdutoQtdSituacao[$idt_instrumento][$idt_produto_situacao] = $vetProdutoQtdSituacao[$idt_instrumento][$idt_produto_situacao]+1;
	}
	$sqll  = 'select ';
    $sqll .= '  grc_pt.* ';
    $sqll .= '  from  db_pir_grc.grc_produto_tipo grc_pt ';
 	
    $sqll .= '  order by grc_pt.codigo ';
    $rsl = execsql($sqll);
	$vetProdutoTipo=Array();
    ForEach ($rsl->data as $rowl) {
        $idt              = $rowl['idt'];
        $descricao        = $rowl['descricao'];
        $vetProdutoTipo[$idt] = $rowl;
    }
	
	$sql1 = "select idt, codigo, descricao from db_pir_grc.grc_atendimento_instrumento ";
    $sql1 .= " order by codigo";
    $rsl = execsql($sql1);
	$vetProdutoInstrumento=Array();
    ForEach ($rsl->data as $rowl) {
        $idt              = $rowl['idt'];
        $descricao        = $rowl['descricao'];
        $vetProdutoInstrumento[$idt] = $rowl;
    }
	
	
	$sql1 = "select idt, codigo, descricao from db_pir_grc.grc_produto_situacao ";
    $sql1 .= " order by codigo";
    $rsl = execsql($sql1);
	$vetProdutoSituacao=Array();
    ForEach ($rsl->data as $rowl) {
        $idt              = $rowl['idt'];
        $descricao        = $rowl['descricao'];
        $vetProdutoSituacao[$idt] = $rowl;
    }
	
	$sql1 = "select idt, codigo, descricao from db_pir_gec.gec_programa ";
    $sql1 .= " order by codigo";
    $rsl = execsql($sql1);
	$vetPrograma=Array();
    ForEach ($rsl->data as $rowl) {
        $idt              = $rowl['idt'];
        $descricao        = $rowl['descricao'];
        $vetPrograma[$idt] = $rowl;
    }
	
    $vetDimensao['Edital']      = $vetEdital;
    $vetDimensao['Programa']    = $vetPrograma;
	$vetDimensao['Area']        = $vetArea;
	$vetDimensao['Area_gc']     = $vetArea_gc;
	$vetDimensao['Produto']     = $vetProduto;
	$vetDimensao['ProdutoArea'] = $vetProdutoArea;
	
	$vetDimensao['Instrumento'] = $vetProdutoInstrumento;
	$vetDimensao['ProdutoTipo'] = $vetProdutoTipo;
	$vetDimensao['ProdutoSituacao'] = $vetProdutoSituacao;
	$vetDimensao['ProdutoQtd']      = $vetProdutoQtd;
	$vetDimensao['ProdutoQtdSituacao']      = $vetProdutoQtdSituacao;
	
	
	
    return $kokw;
}

function QuantitativosProdutoCredenciados($condicao, $vetProduto, $vetProdutoArea, &$vetCredenciados, &$vetCredenciadosP,&$vetCredenciadosR, &$vetCredenciadosRP)
{
    $kokw = 0;
	$vetCredenciados = Array();
	$vetCredenciadosP = Array();
    ForEach ($vetProdutoArea as $idt_produto => $vetarea) {
	   $kwherew     = "";
	   $separa  = " and ";
	   $grc_pt_idt  = "";
	   ForEach ($vetarea as $idt_area => $row)
	   {
	      if ($idt_area=='')
		  {
		      continue;
		  }
	      if ($grc_pt_idt=="")
		  {
	          $grc_pt_idt = $row['grc_pt_idt'];   
			  if ($grc_pt_idt=='')
			  {
			      continue;
			  }
			  $kwherew    = $kwherew.$separa." gec_eac.idt_natureza = {$grc_pt_idt} "; 
		      $separa     = " and ";
		  }	  
	      $kwherew = $kwherew.$separa." gec_eac.idt_area_conhecimento = {$idt_area} "; 
		  $separa  = " and ";
	   } 
	   if ($kwherew=="")
	   {
	       continue;
	   }
	    // acessar quem atende pela área de conhecimento
		$sql  = 'select ';
		$sql .= '  gec_e.idt, gec_e.codigo, gec_e.descricao ';
		$sql .= '  from gec_entidade gec_e   ';
		$sql .= '  inner join gec_entidade_area_conhecimento gec_eac on gec_eac.idt_entidade = gec_e.idt   ';
		$sql .= '  where  ';
		$sql .= '     gec_e.reg_situacao         = '.aspa('A');
		$sql .= '     and    gec_e.tipo_entidade = '.aspa('P');
		$sql .= '     and    gec_e.credenciado   = '.aspa('S');
		$sql .= $kwherew;
		$rs = execsql($sql);
		ForEach ($rs->data as $row)
		{
			$idt_entidade  = $row['idt'];
			$codigo        = $row['codigo'];
			$descricao     = $row['descricao'];
			$vetCredenciados[$idt_produto]=$vetCredenciados[$idt_produto]+1;
			$vetCredenciadosP[$idt_produto][$idt_entidade]=$idt_entidade;
			
		}
		
			
		
		
	}
	
	ForEach ($vetProduto as $idt_produto => $row)
	{
		// acessar quem atende pelo Repasse
		$sql  = 'select ';
		$sql .= '  gec_e.idt, gec_e.codigo, gec_e.descricao,   ';
		$sql .= '  gec_ep.idt_entidade as gec_ep_idt_entidader, gec_ep.idt_produto as gec_ep_idt_produtor  ';
		$sql .= '  from gec_entidade_produto  gec_ep ';
		$sql .= '  inner join gec_entidade gec_e on gec_ep.idt_entidade = gec_e.idt   ';
		$sql .= '  where  ';
		$sql .= '            gec_ep.idt_produto  = '.null($idt_produto);
		$rs = execsql($sql);
		ForEach ($rs->data as $row)
		{
			$idt_entidade  = $row['idt_entidade_r'];
			$codigo        = $row['codigo'];
			$descricao     = $row['descricao'];
			$gec_ep_idt_produtor     = $row['gec_ep_idt_produtor'];
			$gec_ep_idt_entidade     = $row['gec_ep_idt_entidader'];
			$vetCredenciadosR[$gec_ep_idt_produtor]=$vetCredenciadosR[$gec_ep_idt_produtor]+1;
			$vetCredenciadosRP[$gec_ep_idt_produtor][$idt_entidader]=$idt_entidade;
			
		}
	
    } 	
	$kokw = 1;
    return $kokw;
}


$vetDimensao           = Array();
$ret = CriarDimensoesArea($vetDimensao);
$vetEdital   = $vetDimensao['Edital'];
$vetPrograma = $vetDimensao['Programa'];
$vetArea     = $vetDimensao['Area'];
$vetArea_gc  = $vetDimensao['Area_gc'];
$vetProduto  = $vetDimensao['Produto'];
$vetProdutoArea = $vetDimensao['ProdutoArea'];

$vetProdutoQtd = $vetDimensao['ProdutoQtd'];
$vetProdutoQtdSituacao = $vetDimensao['ProdutoQtdSituacao'];
//p($vetPrograma);

$vetProdutoSituacao  = $vetDimensao['ProdutoSituacao'];

$vetProdutoInstrumento = $vetDimensao['Instrumento'];
$condicao       = ""; // todos os produtos
$vetCredenciados   = Array();
$vetCredenciadosP  = Array();
$vetCredenciadosR  = Array();
$vetCredenciadosRP = Array();

QuantitativosProdutoCredenciados($condicao, $vetProduto, $vetProdutoArea, $vetCredenciados, $vetCredenciadosP, $vetCredenciadosR, $vetCredenciadosRP);



// Barra de Ferramentas
echo "<table class='' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class=''>  ";

$onclickA = " onclick = 'return AbreTodosInstrumento();' ";
$hint     = "title = 'Clique aqui para Abrir Todos os Produtos'";
echo "   <td {$onclickA} {$hint} class='cb_barra_ferramenta' style=''>Abrir Todos</td> ";


$onclickA = " onclick = 'return FechaTodosInstrumento();' ";
$hint     = "title = 'Clique aqui para Fechar Todos os Produtos'";
echo "   <td {$onclickA} {$hint} class='cb_barra_ferramenta' style=''>Fechar Todos</td> ";

echo "   <td  class='cb_barra_ferramenta' style='width:80%'>&nbsp;</td> ";


echo "</tr>";
echo "</table>";
//
echo "<table class='' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
//
echo "<tr class=''>  ";
echo "   <td class='cb_texto_cab' style=''>INSTRUMENTO</td> ";
echo "   <td class='cb_texto_cab' style=''>QUANTIDADE TOTAL<BR/> DE PRODUTOS</td> ";
echo "   <td class='cb_texto_cab' style=''>QUANTIDADE DE PRODUTOS<BR/> APROVADOS</td> ";
echo "   <td class='cb_texto_cab' style=''>QUANTIDADE DE PRODUTOS<BR/> DISPONÍVEIS</td> ";
echo "   <td class='cb_texto_cab' style=''>&nbsp;</td> ";
echo "   <td class='cb_texto_cab' style=''>&nbsp;</td> ";
echo "</tr>";
//
$qtd_produto          = 0;
$qtd_produtoTAPW      = 0;
$qtd_produtoTDIW      = 0;
$qtd_credenciadosTRW  = 0;
$qtd_credenciadosTNRW = 0;
//
$instrumentow = "#####";
$naturezaw    = "####";
ForEach ($vetProduto as $idt_produto => $row) {
    $idt_produto      = $row['idt'];
	$idt_instrumento  = $row['idt_instrumento'];
	$rowi             = $vetProdutoInstrumento[$idt_instrumento];
	$instrumento      = strtoupper($rowi['descricao']);
	$idt_programa     = $row['idt_programa'];
	$rowi             = $vetPrograma[$idt_programa];
	$programa         = $rowi['codigo'];
	
	
    $codigo           = $row['codigo'];
    $descricao        = $row['descricao'];
	$ativo            = $row['ativo'];
	$grc_pt_descricao = $row['grc_pt_descricao'];
	$gec_ac_descricao_estruturada = $row['gec_ac_descricao_estruturada'];
	$situacao = $vetProdutoSituacao[$row['idt_produto_situacao']]['descricao'];
	$natureza = $row['grc_pt_descricao'];
	$qtd_produto  = $qtd_produto + 1;
	
	$instrumentoi = '&nbsp;';
	if ($instrumentow != $instrumento)
	{
	    $instrumentow = $instrumento; 
		$instrumentoi = $instrumento; 
		$naturezaw    = $natureza; 
		$naturezai    = $natureza;
        $situacaow    = $situacao; 
		$situacaoi    = $situacao;		
	}
	else
	{
	    $naturezai = '&nbsp;';
		if ($instrumentow.$naturezaw != $instrumento.$natureza)
		{
			$naturezaw    = $natureza; 
			$naturezai    = $natureza; 
			$situacaow    = $situacao; 
			$situacaoi    = $situacao;
		}
		else
		{
			$situacaoi = '&nbsp;';
			if ($instrumentow.$naturezaw.$situacaow != $instrumento.$natureza.$situacao)
			{
				$situacaow    = $situacao; 
				$situacaoi    = $situacao; 
			}
		}
	}
	$brancos="&nbsp;&nbsp;";
	$onclick  = "";
	$hint="";
	$cursor="";
	
	if ($instrumentoi!='&nbsp;')
	{
	
	
	    
	
	    $classw   = 'cb_texto_i';
		$classinw = 'cb_textoin_i';
		$classinstrumento = 'in'.$idt_instrumento; 
		$AbreFechaInstrumento=" onclick = 'return AbreFechaInstrumento(".'"'."{$classinstrumento}".'"'.");'";
		
		$cursor = " cursor:pointer; ";
		$hint   = "Clique para exibir Produtos do Instrumento";
	    echo "<tr class=''>  ";
		$qtd_prodinst   = format_decimal($vetProdutoQtd[$idt_instrumento],0);
		$qtd_prodinstAP = format_decimal($vetProdutoQtdSituacao[$idt_instrumento][2],0);
		$qtd_prodinstDI = format_decimal($vetProdutoQtdSituacao[$idt_instrumento][5],0);
		
		$qtd_produtoTAP      = $qtd_produtoTAP + $vetProdutoQtdSituacao[$idt_instrumento][2];
		$qtd_produtoTDI      = $qtd_produtoTDI + $vetProdutoQtdSituacao[$idt_instrumento][5];

		
        echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw}' style='{$cursor}' >{$brancos} >> {$instrumentoi} </td> ";
		echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classinw}' sty:le='{$cursor}' >{$brancos} {$qtd_prodinst}</td> ";
		echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classinw}' sty:le='{$cursor}' >{$brancos} {$qtd_prodinstAP}</td> ";
		echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classinw}' sty:le='{$cursor}' >{$brancos} {$qtd_prodinstDI}</td> ";
		
		
		echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classinw}' sty:le='{$cursor}' >{$brancos} </td> ";
		echo "   <td {$AbreFechaInstrumento}  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classinw}' sty:le='{$cursor}' >{$brancos} </td> ";
		
		
        echo "</tr>  ";
		echo "<tr class='{$classinstrumento}  eleinst'>  ";
		echo "   <td class='cb_texto_cab' style=''>NATUREZA</td> ";
		echo "   <td class='cb_texto_cab' style=''>SITUAÇÃO</td> ";
		echo "   <td class='cb_texto_cab' style=''>PROGRAMA</td> ";
		echo "   <td class='cb_texto_cab' style=''>DESCRIÇÃO</td> ";
		echo "   <td class='cb_texto_cab' style=''>CREDENCIADOS<BR />COM REPASSE</td> ";
		echo "   <td class='cb_texto_cab' style=''>CREDENCIADOS<BR />ÁREA</td> ";
		echo "</tr>";

	}
	$classw='cb_texto';
	if ($natureza=='Consultoria')
	{
	    $classw='cb_texto_co';
	}
	if ($naturezaw=='Instrutoria')
	{
	    $classw='cb_texto_in';
	}
	$classsitw ='';
	$classsitew='';
	if ($situacaoi=='&nbsp;')
	{
	    $classsitw='cb_texto_si';
	}
	if ($situacaoi=='')
	{
	    $classsitew='cb_texto_siv';
	}
	$onclickR = " onclick = 'return DetalhaCredenciadosRepasse($idt_produto); '";
	$hintR    = "Clique aqui para Credenciados com Repasse";
	$cursorR  = "cursor:pointer;";
	echo "<tr class='{$classinstrumento} eleinst'>  ";
	echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} ' style='{$cursor}' >{$brancos}{$naturezai}</td> ";
	echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} {$classsitw} {$classsitew}' style='{$cursor}' >{$brancos}{$situacaoi}</td> ";
    echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw}' style='{$cursor}' >{$brancos}{$programa}</td> ";
	echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw}' style='{$cursor}' >{$brancos}{$descricao}</td> ";
	$qtd_credenciadosw = format_decimal($vetCredenciadosR[$idt_produto],0);
	echo "   <td id='{$id_linha}'  {$onclickR} title='{$hintR}' class='{$classw} cb_inteiro' style='{$cursorR}' >{$brancos}$qtd_credenciadosw</td> ";
	$qtd_credenciadosw = format_decimal($vetCredenciados[$idt_produto],0);
	echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos}$qtd_credenciadosw</td> ";
	echo "</tr>  ";
	$qtd_credenciadosTR  = $qtd_credenciadosTR+$vetCredenciadosR[$idt_produto];
    $qtd_credenciadosTNR = $qtd_credenciadosTNR+$vetCredenciados[$idt_produto];

	
}


echo "<tr class=''>  ";
$classw = 'cb_texto_tt';

echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos}TOTAL</td> ";


$qtd_produtow = format_decimal($qtd_produto,0);
echo "   <td  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos} {$qtd_produtow}</td> ";

$qtd_produtoTAPW = format_decimal($qtd_produtoTAP,0);
echo "   <td  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos} {$qtd_produtoTAPW}</td> ";

$qtd_produtoTDIW = format_decimal($qtd_produtoTDI,0);
echo "   <td  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos} {$qtd_produtoTDIW}</td> ";

$qtd_credenciadosTRW = format_decimal($qtd_credenciadosTR,0);
$qtd_credenciadosTRW = '&nbsp';
echo "   <td  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos} {$qtd_credenciadosTRW}</td> ";

$qtd_credenciadosTNRW = format_decimal($qtd_credenciadosTNR,0);
$qtd_credenciadosTNRW = '&nbsp';
echo "   <td  id='{$id_linha}'  {$onclick} title='{$hint}' class='{$classw} cb_inteiro' style='{$cursor}' >{$brancos} {$qtd_credenciadosTNRW}</td> ";

echo "</tr>  ";

	
	
	
	
	
echo "<br />";
echo "<br />";

/*

$condicao       = ""; // todos os produtos
// QuantitativosAtendimento($vetInstrumento,$vetPontoUR,$idt_dimensao, $condicao, $vetDimensao,$vetDimensaoTotal,$TotalGeral_G, $vetDimensaoInstrumento, $vetDimensaoTempoI, $vetDimensaoTempoP);
$vetAtendimentoQtd = $vetDimensao;
  
// Barra de Ferramentas
echo "<table class='' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class=''>  ";

$onclickA = " onclick = 'return AbreParametros();' ";
$hint     = "title = 'Clique aqui para parametrizar a Visualização das linhas da Matriz'";
echo "   <td {$onclickA} {$hint} class='cb_barra_ferramenta' style=''>Visualização</td> ";

echo "   <td  class='cb_barra_ferramenta' style='width:90%'>&nbsp;</td> ";


echo "</tr>";
echo "</table>";

echo "<div id='parametros' class='parametros_visualizacao'>";

echo "<div id='parametros_linhas' class='parametros_l1'>";
$onclickA = " onclick = 'return Parametros_ocultar_ur();' ";
$hint     = "title = 'Clique aqui para Ocultar as linhas das Unidades Regionais'";
echo "   <a {$onclickA} {$hint} class='cb_barra_ferramenta' style=''>Ocultar/Exibir linhas das Unidades Regionais</a> ";
echo "</div>";

echo "<div id='parametros_linhas' class='parametros_l1'>";
$onclickA = " onclick = 'return Parametros_ocultar_pa();' ";
$hint     = "title = 'Clique aqui para Ocultar as linhas dos PAs '";
echo "   <a {$onclickA} {$hint} class='cb_barra_ferramenta' style=''>Ocultar/Exibir linhas dos PAs</a> ";
?cho "</div>";

echo "</div>";

echo "<br />";


//
echo "<table class='' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ";
echo "<tr class=''>  ";
$data_inicio='01/01/2016'; 
$data_final ='31/12/2016'; 
echo "   <td colspan='11' class='cb_texto_tit' style='' >Período de {$data_inicio} até {$data_final}</td> ";
echo "</tr>";
echo "<tr class=''>  ";
echo "   <td rowspan='2' class='cb_texto_int_cab cb_texto_cab1' style='width:27%'>Unidade Regional<br />Ponto de Atendimento</td> ";
ForEach ($vetInstrumento as $idt => $row) {
    echo "   <td colspan='2' class='cb_texto_int_cab' style='width:16'>{$row['descricao']}</td> ";
}
echo "   <td colspan='2' class='cb_texto_int_cab' style='width:16%'>TOTAL</td> ";

echo "   <td colspan='2' class='cb_texto_int_cab' style='width:13%'>TEMPO</td> ";


echo "</tr>";
echo "<tr class=''>  ";
ForEach ($vetInstrumento as $idt => $row) {
    echo "   <td class='cb_texto_int_subcab' style=''>Quantidade</td> ";
    echo "   <td class='cb_texto_int_subcab' style=''>%</td> ";
}
echo "   <td class='cb_texto_int_subcab' style=''>Quantidade</td> ";
echo "   <td class='cb_texto_int_subcab' style=''>%</td> ";

echo "   <td class='cb_texto_int_subcab' style=''>TOTAL</td> ";
echo "   <td class='cb_texto_int_subcab' style=''>MÉDIO</td> ";

echo "</tr>";


$tempo_total_G = 0;
ForEach ($vetPontoAtendimento as $idt_ponto_atendimento => $row) {
    $i = $i + 1;
	$brancos="";
	$hint="";
	$id_linha=$idt_ponto_atendimento;
	if ($row['tipo_estrutura']=='UR')
	{
        $classw  =  'cb_texto_linha_imp ur ';
		$idt_ur  = $idt_ponto_atendimento;
		$onclick = " onclick = 'return AbreFechaUnidade($idt_ur); '";
		$hint="Clique aqui para Abrir/Fechar Unidade Regional";
	}
	else
	{
	    $hint="Clique aqui para Detalhar os ATENDIMENTOS do Ponto de Atendimento";
	    $classw =   "cb_texto_linha_par pa pa{$idt_ur}";
	    $brancos="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
		$onclick = " onclick = 'return DetalhaPA($idt_ponto_atendimento); '";
	}
    echo "<tr class=''>  ";
	
    echo "   <td id='{$id_linha}'  {$onclick} title='{$hint}'class='cb_texto {$classw}' style='cursor:pointer;' >{$brancos}{$row['descricao']}</td> ";
	$TotalGeral = $vetDimensaoTotal[$idt_ponto_atendimento];
	
	ForEach ($vetInstrumento as $idt => $row) {
	    $quantidade = $vetDimensao[$idt_ponto_atendimento][$idt];
        echo "   <td class='cb_inteiro {$classw}' style='' >$quantidade</td> ";
	    $perc=0;
	    if ($TotalGeral>0)
	    {
            $perc = ($quantidade / $TotalGeral) * 100;
	    }
        $percw = format_decimal($perc, 2).' %';
        echo "   <td class='cb_perc {$classw}' style='' >$percw</td> ";
    }
    echo "   <td class='cb_inteiro {$classw}' style='' >$TotalGeral</td> ";
    $perc=0;
    if ($TotalGeral_G>0)
    {
        $perc = ($TotalGeral / $TotalGeral_G) * 100;
    }
    $percw = format_decimal($perc, 2).' %';
    echo "   <td class='cb_perc {$classw}' style='' >$percw</td> ";



    $tempo_total = $vetDimensaoTempoP[$idt_ponto_atendimento];
	
	$tempo_total_G = $tempo_total_G +  $tempo_total;
	
	echo "   <td class='cb_perc {$classw}' style='' >$tempo_total</td> ";
    $media=0;
	if ($TotalGeral>0)
	{
        $media = ($tempo_total / $TotalGeral) ;
	}
    $mediaw = format_decimal($media, 1).' min';
    echo "   <td class='cb_perc {$classw}' style='' >$mediaw</td> ";


    echo "</tr>";

}  
// linha total geral
echo "<tr class=''>  ";
    $classw='class_t';
    echo "   <td class='cb_texto {$classw}' style='text-align:right' >TOTAL GERAL</td> ";
	$TotalGeral = $vetDimensaoTotal[$idt_ponto_atendimento];
	
	ForEach ($vetInstrumento as $idt => $row) {
	    $quantidade = $vetDimensaoInstrumento[$idt];
        echo "   <td class='cb_inteiro {$classw}' style='' >$quantidade</td> ";
	    $perc=0;
	    if ($TotalGeral_G>0)
	    {
            $perc = ($quantidade / $TotalGeral_G) * 100;
	    }
        $percw = format_decimal($perc, 2).' %';
        echo "   <td class='cb_perc {$classw}' style='' >$percw</td> ";
    }
    echo "   <td class='cb_inteiro {$classw}' style='' >$TotalGeral_G</td> ";
    $perc=0;
    if ($TotalGeral_G>0)
    {
        $perc = ($TotalGeral_G / $TotalGeral_G) * 100;
    }
    $percw = format_decimal($perc, 2).' %';
    echo "   <td class='cb_perc {$classw}' style='' >$percw</td> ";



	echo "   <td class='cb_perc {$classw}' style='' >$tempo_total_G</td> ";
    $media=0;
	if ($TotalGeral_G>0)
	{
        $media = ($tempo_total_G / $TotalGeral_G) ;
	}
    $mediaw = format_decimal($media, 1).' min';
    echo "   <td class='cb_perc {$classw}' style='' >$mediaw</td> ";








    echo "</tr>";
echo "</table>";

echo "<br /><br />";
*/

?>



<script type="text/javascript" >

//    var idt_organizacao = <?php echo $idt_organizacao; ?>;



function DetalhaCredenciadosRepasse(idt_produto)
{
    var descricao_produto = "pegar descricao do produto";
    //alert('Detalha Area'+idt_area);

    var parww='&idt_produto='+idt_produto+'&produto='+descricao_produto;
    var href='conteudo_detalha_produto.php?prefixo=inc&menu=detalha_produto_repasse'+parww;
    var  left   = 0;
    var  top    = 0;
    var  height = $(window).height();
    var  width  = $(window).width();
    top    = 200;
    left   = 300;
	
	top    = 100;
    left   = 25;
	
    width  = width  - 50;
    height = height - 50;
	
	
    var titulo = "<div style='width:700px; display:block; text-align:center; '>Detalha Produto - "+descricao_produto+"</div>";
    showPopWin(href, titulo , width, height, close_DetalhaProduto);
    return false;
}

function close_DetalhaProduto(returnVal) {
    // alert(returnVal);
    // var href = "conteudo_tipologia_medicao.php?prefixo=inc&menu=mapa_medicao&print=s&lupa=s&titulo_rel=&ampliar=S&origem=S&idt_empreendimento="+idt_empreendimento;
    // self.location =  href;

}
		
function AbreFechaInstrumento(instrumento)
{
//    alert('Unidade Regional'+idt_ur);
	 var classew = instrumento;
	 $('.'+classew).each(function () {
        $(this).toggle(); 
    });
	return false;
}

function AbreTodosInstrumento()
{
	 var classew = 'eleinst';
	 $('.'+classew).each(function () {
        $(this).show(); 
    });
	return false;
}

function FechaTodosInstrumento()
{
	 var classew = 'eleinst';
	 $('.'+classew).each(function () {
        $(this).hide(); 
    });
	return false;
}





function AbreParametros()
{
	$('#parametros').show(); 
	return false;
}

function FechaParametros()
{
	$('#parametros').hide(); 
	return false;
}

function Parametros_ocultar_ur()
{
	 var classew = 'ur';
	 $('.'+classew).each(function () {
        $(this).toggle();  
    });
	return false;
}

function Parametros_ocultar_pa()
{
	 var classew = 'pa';
	 $('.'+classew).each(function () {
        $(this).toggle();  
    });
	return false;
}



/*





    function ChamaDepto(codigo_secao)
    {
        alert(codigo_secao);
        //alert(' gggg '+em_idt);
        var opcao = "A";
        var parww = '&codigo_secao=' + idt_organizacao + '&codigo_secao=' + idt_organizacao;
        var href = 'conteudo_matriz_pessoas.php?prefixo=inc&menu=matriz_lista_pessoas&print=n&titulo_rel=Pessoas Associadas a seção ' + codigo_secao;
        var left = 0;
        var top = 0;
        var height = $(window).height();
        var width = $(window).width();
        top = 100;
        left = 150;
        width = width - 200;
        height = height - 350;
        var titulo = "<div style='width:700px; display:block; text-align:center; '>Pessoas Associadas a seção " + codigo_secao + "</div>";
        showPopWin(href, titulo, width, height, close_ChamaDepto, true, top, left);
        //***

        return false;
    }

//Esmeraldo
    function close_ChamaDepto(returnVal) {
        //alert(returnVal);
        //var href = "conteudo_tipologia.php?prefixo=inc&menu=tipologia_medicao&print=s&lupa=s&titulo_rel=&ampliar=S&origem=S&idt_empreendimento="+idt_empreendimento;
        //self.location =  href;

    }
    function ChamaDeptoCargo(codigo_secao, cargo)
    {
        alert(codigo_secao + ' ====  ' + cargo);

        return false;
    }
	
*/	
	
</script>
