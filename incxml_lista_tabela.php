
<style type="text/css">


div#contrato {
    soverflow:auto;
    sheight: 380px;
    swidth : 680px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    background: #FFFFFF;
    margin-top:0px;
}


div#contrato_1 {
    soverflow:auto;
    sheight: 360px;
    width : 670px;
    width : 100%;
    float:left;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#FF5959;
    padding:0px;
    background: #FFFFFF;
}


table.contrato_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EFEFEF;
    background: #A2A2A2;
}

tr.contrato_table_tr {


}
td.contrato_titulo_td {
    font-weight : normal;
    color       : #FFFFFF;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
}
tr.contrato_cab_tr {

}
td.contrato_cab_td {
    font-weight :normal;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #F1F1F1;
}

td.contrato_cab_td_r {
    font-weight :normal;
    color       :#FFFFFF;
    text-align  :left;
    padding-top :5px;
    padding-left:5px;
    border-bottom:1px solid #9D0000;
    text-align: right;
}

tr.contrato_linha_tr {

}
td.contrato_linha_td_t {
    font-weight   : normal;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t1 {
    font-weight   : normal;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t2 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_t3 {
    font-weight   : normal;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
}


td.contrato_linha_td_t_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EAEAEA;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t1_r {
    font-weight   : bold;
    color         : #640000;
    background    : #EEEEEE;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t2_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_t3_r {
    font-weight   : bold;
    color         : #640000;
    background    : #F0F0F0;
    padding-top   : 5px;
    padding-left  : 5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}



td.contrato_linha_td_a {
    font-weight :normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
}

td.contrato_linha_td_a_r {
    font-weight : normal;
    color       :#575757;
    background  :#FFFFFF;
    padding-top :5px;
    padding-left:5px;
    border-bottom : 1px solid #C0C0C0;
    text-align    : right;
}

td.contrato_linha_td_a_r a {
    font-weight : bold;
    color       :#900000;
    text-decoration:none;
}

div#contrato_c {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    height:10px;
    margin:0px;
}

div#contrato_r {
    background:#FFCCCC;
    background:#FFFFFF;
    width : 680px;
    sheight:10px;
    margin:0px;
    float:left;
    padding-bottom:20px;
}


.quantidade_contrato {
    background:#E9E9E9;
    swidth : 100%;
    font-family :  Arial, Calibri, Helvetica, sans-serif;
    font-style: normal;
    font-size: 14px;
    font-weight: bold;
    color:#666666;

}


div#mostra_aditivo {
    position:absolute;
    
    left:240px;
    top:150px;
    
    width :700px;
    height:200px;
    
    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#mostra_aditivo img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#mostra_aditivo_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#mostra_aditivo_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#mostra_aditivo_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}

td.cabecalho_campo {
   color: #FFFFFF;
   font-weight: bold;
   padding-bottom:10px;
   border-bottom:1px;
   background:#808080;

}
td.linha_campo {
   color: #202020;
}


div#posicao_periodo {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Arial, Calibri,  Helvetica,  sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda {
    width : 670px;
    width : 100%;
    height: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}

div#legenda_l {
    font-size: 11px;
    color:#000000;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}


div#legenda_i {
    font-size: 11px;
    color:#858585;
    sfloat:left;
    float:right;
    padding-top:10px;
    margin-left:5px;
    margin-right:5px;
}
div#legenda_i img {
    color:#858585;
    font-weight: bold;
}
div#legenda_i span {
    color:#858585;
    font-weight: bold;
}


table.legenda_table{
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-style: normal;
    font-size: 12px;
    font-weight: normal;
    color:#000000;
    background: #EAEAEA;
}

tr.legenda_cab_tr {


}
td.legenda_cab_td {
    font-weight : bold;
    color       : #B9B9B9;
    text-align  :center;
    padding-top :5px;
    padding-left:5px;
    border-bottom: 1px solid #000000;
}


div#legenda_maior {
    width : 670px;
    sheight: 30px;
    float:left;
    font-family : Calibri, Arial, Helvetica,  sans-serif;
    font-style: normal;
    font-size: 11px;
    font-weight: bold;
    color:#000000;
    padding:0px;
    background: #EAEAEA;
    margin-bottom:5px;
}




div#contrato_edoc {
    position:absolute;

    left:240px;
    top:150px;

    width :700px;
    height:200px;

    background-color: white;
    border:2px solid #808040;
    display:none;

    z-index:2000000;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: bold;
    color: #004080;
    text-align:center;
    background: #EBEBEB;
    overflow:auto;
}

div#contrato_edoc img{
    float:right;
    padding-top:5px;
    padding-right:5px;
    padding-bottom:5px;
}

div#contrato_edoc_cab {
    width :696px;
    height:30px;
    border:2px solid #C0C0C0;
    color:white;
    background: #004080 ;
}

div#contrato_edoc_det {
    padding-top:5px;
    padding-left:3px;
    font-family : Calibri, Arial, Helvetica, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
    color: #A6A6A6;
    text-align:left;

}

div#contrato_edoc_det img {
    float:left;
    padding-top:0px;
    padding-left:10px;

}


div#voltar_full_m  {
    float:left;
    height:25px;
    background:transparent;
    sbackground:red;
    margin:0px;
    padding:0px;
}

div#voltar_full_m img {
    cursor: pointer;
}

.voltar  {
    float:left;
}


div#area_imprime {
    float:left;
    background: #FFFFFF;
    text-align:right;
    background:blue;

}
div#area_imprime img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_excel {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_excel img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}

div#area_doc {
    float:left;
    background: #FFFFFF;
    text-align:right;

}
div#area_doc img {
    background: #FFFFFF;
    padding-right:5px;
    cursor: pointer;
}
</style>

<?php
$codigo_secao    =  $_GET['codigo_secao'];
$idt_organizacao =  $_GET['idt_organizacao'];
$idt_eap         =  $_GET['idt_eap'];
 
$tela = new TGSWTel();

// Processos
$vetEstruturaDir = Array();
$vetEstruturaDir['admin']           = 'admin/';
$vetEstruturaDir['listar_conf']     = 'admin/listar_conf/';
$vetEstruturaDir['cadastro_conf']   = 'admin/cadastro_conf/';
$vetEstruturaDir['classes']         = 'admin/classes/';
$vetEstruturaDir['listar_cmb']      = 'admin/listar_cmb/';
$vetEstruturaDir['listar_cmbmulti'] = 'admin/listar_cmbmulti/';
$vetEstruturaDir['relatorio']       = 'admin/relatorio/';
$vetEstruturaDirD = Array();
$vetEstruturaDirD['admin']          = 'Processos do CRM|Sebrae';
$vetEstruturaDirD['listar_conf']    = 'Programas de Lista de Linhas de Tabelas';
$vetEstruturaDirD['cadastro_conf']  = 'Programas de Ficha de uma Linha de Tabela';
$vetEstruturaDirD['classes']        = 'Programas - Classes Genéricas';
$vetEstruturaDirD['listar_cmb']     = 'Programas de Lista/Seleciona Linha de Tabelas';
$vetEstruturaDirD['listar_cmbmulti']= 'Programas de Lista/Seleciona Linhas de Tabelas';
$vetEstruturaDirD['relatorio']      = 'Programas de Visualização e Relatórios de Tabelas';

$tela->TelaC("<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ");
$tela->TelaC("<tr class='contrato_cab_tr'>  ");
$tela->TelaC("   <td colspan='2' class='contrato_cab_td' style='font-size:20px; background:#2A5696; color:#FFFFFF; text-align:center;' >LISTA ESTRUTURA</td> ");
$tela->TelaC("</tr>");


ForEach ($vetEstruturaDir as $diretorio => $campo)
{
    $path              = $diretorio;
	$descricao         = $vetEstruturaDirD[$diretorio];
	$tela->TelaC("<tr class='contrato_cab_tr'>  ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$path</td> ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$descricao</td> ");
	$tela->TelaC("</tr>");
}




$tela->TelaC("</table> ");





$vetCampo['path']      = CriaVetTabela('Path');
$vetCampo['executa']    = CriaVetTabela('Executar');
$vetCampo['descricao'] = CriaVetTabela('Descrição');
$vetCampo['gsw_pft_descricao'] = CriaVetTabela('Tipo');
$vetCampo['ativo']     = CriaVetTabela('Ativo?', 'descDominio', $vetSimNao );
$sql   = "select ";
$sql  .= "   {$AliasPric}.*,  ";
$sql  .= "   gsw_pft.descricao as gsw_pft_descricao ";
$sql  .= " from {$TabelaPrinc} as {$AliasPric} ";
$sql  .= "   inner join gsw_processo_fisico_tipo gsw_pft on gsw_pft.idt = {$AliasPric}.idt_tipo  ";
$sql .= ' where 1 = 1 ';



$sqll   = 'select ';
$sqll  .= '  gsw_ps.*, ';
$sqll .= "   gsw_pft.descricao as gsw_pft_descricao ";
$sqll  .= '  from  gsw_processo_fisico gsw_ps ';
$sqll  .= "   inner join gsw_processo_fisico_tipo gsw_pft on gsw_pft.idt = gsw_ps.idt_tipo  ";
$sqll  .= '  order by path, executa ';
$rsl    = execsql($sqll);
$tela->TelaC("<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ");
$tela->TelaC("<tr class='contrato_cab_tr'>  ");
$tela->TelaC("   <td colspan='4' class='contrato_cab_td' style='font-size:20px; background:#2A5696; color:#FFFFFF; text-align:center;' >LISTA PROCESSOS</td> ");
$tela->TelaC("</tr>");
//
$qtd_linha_to_t = 0;
$qtd_linha_ut_t = 0;
$qtd_linha_in_t = 0;
//

$tela->TelaC("<tr class='contrato_cab_tr'>  ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Path</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Executa</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Descrição</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Tipo</span></td> ");
$tela->TelaC("</tr>");

ForEach($rsl->data as $rowl)
{
    $quantidadeTotal   = $quantidadeTotal + 1;
    $path              = $rowl['path'];
	$executa           = $rowl['executa'];
	$descricao         = $rowl['descricao'];
	//
	$qtd_linha_to      = $rowl['qtd_linha_to'];
    $qtd_linha_ut      = $rowl['qtd_linha_ut'];
    $qtd_linha_in      = $rowl['qtd_linha_in'];
	//
	$qtd_linha_to_t    = $qtd_linha_to_t + $qtd_linha_to;
	$qtd_linha_ut_t    = $qtd_linha_ut_t + $qtd_linha_ut;
	$qtd_linha_in_t    = $qtd_linha_in_t + $qtd_linha_in;
    // 
	$gsw_pft_descricao = $rowl['gsw_pft_descricao'];
	$tela->TelaC("<tr class='contrato_cab_tr'>  ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$path</td> ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$executa</td> ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$descricao</td> ");
	$tela->TelaC("   <td class='contrato_cab_td' style='background:#FFFFFF; color:#000000; text-align:left;' >&nbsp;&nbsp;&nbsp;$gsw_pft_descricao</td> ");
	$tela->TelaC("</tr>");
}

// qtd_linha_to
// qtd_linha_ut
// qtd_linha_in
// percentual_util


$quantidadeTotalw = format_decimal($quantidadeTotal,0);
//
$qtd_linha_to     = format_decimal($qtd_linha_to_t,0);
$qtd_linha_ut     = format_decimal($qtd_linha_ut_t,0);
$qtd_linha_in     = format_decimal($qtd_linha_in_t,0);
//
$percentual_utilw = ($qtd_linha_ut/$qtd_linha_to)*100;
//
$percentual_util = format_decimal($percentual_utilw,2);
//
$tela->TelaC("</table> ");

$tela->TelaC("<table class='contrato_table' width='100%' border='0' cellspacing='0' cellpadding='0' vspace='0' hspace='0'> ");

$tela->TelaC("<tr class='contrato_cab_tr'>  ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Qtd. Programas</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Qtd. de Linhas</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Qtd. de Úteis</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;Qtd. de Não Executável</span></td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#C4C9CD; text-align:left; ' ><span style='font-size:18px;'>&nbsp;% Executável</span></td> ");
$tela->TelaC("</tr>");


$tela->TelaC("<tr class='contrato_cab_tr'>  ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#FF0000; font-size:16px; color:#ffffff; text-align:right;' >&nbsp;&nbsp;&nbsp;{$quantidadeTotalw}</td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#FF0000; font-size:16px; color:#ffffff; text-align:right;' >&nbsp;&nbsp;&nbsp;{$qtd_linha_to}</td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#FF0000; font-size:16px; color:#ffffff; text-align:right;' >&nbsp;&nbsp;&nbsp;{$qtd_linha_ut}</td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#FF0000; font-size:16px; color:#ffffff; text-align:right;' >&nbsp;&nbsp;&nbsp;{$qtd_linha_in}</td> ");
$tela->TelaC("   <td class='contrato_cab_td' style='background:#FF0000; font-size:16px; color:#ffffff; text-align:left;' >&nbsp;{$percentual_util}</td> ");
$tela->TelaC("</tr>");
$tela->TelaC("</table> ");

$verResp = $tela->TelaE();

$html = $verResp['html'];

$opcaoTela=1;
if ($opcaoTela==1)
{
    echo $html;
	
//	p($vetQtdTabelas);
	
}	
if ($opcaoTela==2)
{
    $arquivo = 'ListMacroProcessos.doc'; // Definindo o nome do documento e sua extensão – .doc ou .xls
	header ("Content-type: application/msword"); 
	//Definindo em que formato abrir – application/msword para .doc e application/x-msexcel para .xls
	header ("Content-Disposition: attachment; filename='{$arquivo}'" ); //Gerando o arquivo
	echo $html; //Mostrando o arquivo
}	
if ($opcaoTela==99)
{
   p($verResp['veto']);
}

?>



<script type="text/javascript" >


</script>
